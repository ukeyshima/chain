!function(e){function t(t){for(var n,i,s=t[0],c=t[1],l=t[2],d=0,p=[];d<s.length;d++)i=s[d],r[i]&&p.push(r[i][0]),r[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(u&&u(t);p.length;)p.shift()();return a.push.apply(a,l||[]),o()}function o(){for(var e,t=0;t<a.length;t++){for(var o=a[t],n=!0,s=1;s<o.length;s++){var c=o[s];0!==r[c]&&(n=!1)}n&&(a.splice(t--,1),e=i(i.s=o[0]))}return e}var n={},r={1:0};var a=[];function i(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=n,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="http://localhost:3000/";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;a.push([667,0]),o()}({120:function(e,t,o){var n=o(320);"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};o(23)(n,r);n.locals&&(e.exports=n.locals)},182:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(o(2)),r=o(87),a=i(o(120));function i(e){return e&&e.__esModule?e:{default:e}}const{white0:s}=a.default;t.default=(e=>{const{points:t,strokeDasharray:o}=e;return n.default.createElement("polyline",{points:(0,r.cosineCurvePoints)(...t),fill:"none",stroke:s,strokeWidth:3,strokeDasharray:o})})},267:function(e,t,o){(e.exports=o(24)(!1)).push([e.i,"html,\nbody,\nmain {\n  width: 100%;\n  height: 100%; }\n\nbody {\n  margin: 0;\n  font-family: sans-serif; }\n\n.ReactCodeMirror {\n  height: 100%; }\n\n.CodeMirror {\n  height: 100%; }\n\n.nwse-resize * {\n  cursor: nwse-resize; }\n\n.user-select-none {\n  cursor: default;\n  -webkit-user-select: none;\n  -webkit-touch-callout: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  -o-user-select: none; }\n\n.move * {\n  cursor: move; }\n",""])},268:function(e,t,o){var n=o(267);"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};o(23)(n,r);n.locals&&(e.exports=n.locals)},269:function(e,t,o){(t=e.exports=o(24)(!1)).push([e.i,"body {\n  box-sizing: border-box; }\n\n.App__wrap_1SQHV {\n  width: 100%;\n  height: 100%;\n  background-color: #1e1e1e; }\n  .App__wrap_1SQHV footer {\n    position: fixed;\n    left: 0;\n    bottom: 0;\n    width: 100%;\n    border-top: 1px solid #2b2b2b;\n    color: #d4d4d4;\n    background-color: #1e1e1e; }\n\n.App__base_2Rw2G {\n  position: relative;\n  width: 100%;\n  height: calc(100% - 36px); }\n  .App__base_2Rw2G > * {\n    position: absolute;\n    width: 100%;\n    height: 100%; }\n\n.App__link_36M0v {\n  font-weight: 100;\n  padding: 5px 10px;\n  color: #555555;\n  display: inline-block;\n  text-decoration: none; }\n  .App__link_36M0v > span {\n    padding: 3px 6px;\n    display: inline-block;\n    border-bottom: 1px transparent solid; }\n\n.App__active_3QbdL {\n  color: #d4d4d4; }\n  .App__active_3QbdL > span {\n    border-bottom-color: #007acc; }\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",wrap:"App__wrap_1SQHV",base:"App__base_2Rw2G",link:"App__link_36M0v",active:"App__active_3QbdL"}},270:function(e,t,o){var n=o(269);"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};o(23)(n,r);n.locals&&(e.exports=n.locals)},285:function(e,t,o){"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(2),i=d(a),s=o(48),c=d(o(30)),l=d(o(284));o(279),o(277),o(275),o(271);var u=d(o(67));function d(e){return e&&e.__esModule?e:{default:e}}let p=(0,s.connect)(({htmlEditor:e})=>({code:e}))((h=(r=class extends a.Component{onChange(e){const{props:{dispatch:t}}=this;t(c.default.onChangeHtml(e))}render(){const{props:{code:e}}=this;return i.default.createElement(l.default,{value:e,onChange:this.onChange,options:{mode:"htmlmixed",theme:"monokai",styleActiveLine:!0,lineNumbers:!0}})}}).prototype,f="onChange",_=[u.default],b=Object.getOwnPropertyDescriptor(r.prototype,"onChange"),g=r.prototype,m={},Object.keys(b).forEach(function(e){m[e]=b[e]}),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=_.slice().reverse().reduce(function(e,t){return t(h,f,e)||e},m),g&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(g):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(h,f,m),m=null),n=r))||n;var h,f,_,b,g,m;t.default=p},286:function(e,t,o){(t=e.exports=o(24)(!1)).push([e.i,".HTMLRenderer__base_y4ZXu {\n  display: block;\n  width: 100%;\n  height: 100%;\n  border: none;\n  background-color: white;\n  position: absolute;\n  left: 0;\n  top: 0; }\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",base:"HTMLRenderer__base_y4ZXu"}},287:function(e,t,o){var n=o(286);"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};o(23)(n,r);n.locals&&(e.exports=n.locals)},290:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=h(o(289)),a=h(o(78)),i=h(o(288)),s=h(o(97)),c=o(2),l=h(c),u=o(48),d=o(41),p=h(o(84));function h(e){return e&&e.__esModule?e:{default:e}}o(287);const f=new DOMParser;let _=(0,u.connect)(({blocks:e,pinLinks:t,htmlEditor:o})=>({blocks:e,links:t,html:o}))(n=class extends c.Component{constructor(){super(),this._vars=[]}shouldComponentUpdate(e){const{props:{blocks:t,links:o,html:n}}=this,{blocks:r,links:a,html:i}=e;return!p.default.is(t.slice(1),r.slice(1))||!p.default.is(o,a)||!p.default.is(n,i)}toEvalableString(){const{props:{blocks:e}}=this,t=e.first();return t?this.toEvalableStringSub(t.get("id")):null}toEvalableStringSub(e){if(null===e)return"null";const{props:{blocks:t}}=this,o=t.find(t=>t.get("id")===e),n=o.get("inputPins").map(t=>this.toEvalableStringSub(this.findOutputBlockIdFromLinks({input:{block:e,pin:t.get("index")}}))).toJS();switch(o.get("type")){case d.BLOCK.TYPE_VIEW:return(0,s.default)(n,e=>{const t=e.match(/_timer_variable_\d+_(.*?)_/);return t?`setInterval(() => {\n\t\t\t\t\t\t\t${e}\n\t\t\t\t\t\t\t${t[0]} += 1;\n\t\t\t\t\t\t}, 1000 / ${t[1]})`:e});case d.BLOCK.TYPE_VALUE:return o.get("value");case d.BLOCK.TYPE_FUNCTION:const[e,...t]=n,c=`(${(0,i.default)(t,", ")})`;return e?`${e}[${JSON.stringify(o.get("value"))}]${c}`:`${o.get("value")}${c}`;case d.BLOCK.TYPE_PROPERTY:return`${n[0]}[${JSON.stringify(o.get("value"))}]`;case d.BLOCK.TYPE_OPERATOR:return`(${n[0]}${o.get("value")}${n[1]})`;case d.BLOCK.TYPE_MATH:const{expression:l,args:u,flattenArgs:p}=o.get("handwriting");let h="",f=0;return(0,a.default)(u,({char:e,index:t})=>{h+=l.substring(f,t)+n[(0,r.default)(p,e)],f=t+1}),`(${h+=l.slice(f)})`;case d.BLOCK.TYPE_TIMER:const _=`_timer_variable_${Date.now()}_${o.get("value")}_`;return this._vars.push(_),_;default:return'"UNKNOWN_BLOCK"'}}findOutputBlockIdFromLinks(e){const{props:{links:t}}=this;let o=null;return t.some(t=>!!t.match(e)&&(o=t.getIn(["output","block"]),!0)),o}render(){this._vars=[];const{props:{html:e},_vars:t}=this,o=f.parseFromString(e,"text/html"),n=o.querySelector("body"),r=document.createElement("script"),a=(0,i.default)((0,s.default)(this.toEvalableString(),e=>`parent.postMessage({ type: 'chain-result', value: ${e} }, '*')`),"\n");return r.innerHTML=`\n\t\t\t${(0,i.default)((0,s.default)(t,e=>`let ${e} = 0;`),"\n")}\n\t\t\tparent.postMessage({ type: 'chain-clear' }, '*');\n\t\t\ttry {\n\t\t\t\t(0, eval)(${JSON.stringify(a)});\n\t\t\t} catch (err) {\n\t\t\t\tparent.postMessage({ type: 'chain-error', value: String(err) }, '*');\n\t\t\t}\n\t\t`,n.appendChild(r),l.default.createElement("iframe",{srcDoc:`<!doctype html>${o.documentElement.outerHTML}`,className:"HTMLRenderer__base_y4ZXu"})}})||n;t.default=_},292:function(e,t){e.exports='<!doctype html>\n<html>\n\n<head>\n    <meta charset="utf-8" />\n</head>\n\n<body>\n    <h1>Hello, World!</h1>\n</body>\n\n</html>'},293:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(65),r=i(o(30)),a=i(o(292));function i(e){return e&&e.__esModule?e:{default:e}}t.default=(0,n.handleActions)({[r.default.onChangeHtml]:(e,t)=>{const{payload:o}=t;return o}},a.default)},294:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=o(84),a=o(83),i=o(65),s=o(30),c=(n=s)&&n.__esModule?n:{default:n};t.default=(0,i.handleActions)({[c.default.addPinLink]:(e,t)=>{const{payload:o}=t,n={input:o.input};return e.filter(e=>!e.match(n)).push(new a.PinLink(o))},[c.default.deleteBlock]:(e,t)=>{const{payload:o}=t;return e.filter(e=>!e.hasBlock(o))},[c.default.removePinLinkByQuery]:(e,t)=>{const{payload:o}=t;return e.filter(e=>!e.match(o))},[c.default.deletePin]:(e,t)=>{const{payload:{id:o,removed:n}}=t;return 0===n?e:e.filter(e=>!e.match({input:{block:o,pin:n}}))}},(0,r.List)())},295:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=o(83),a=o(65),i=o(30),s=(n=i)&&n.__esModule?n:{default:n};t.default=(0,a.handleActions)({[s.default.startPointLink]:(e,t)=>{const{payload:{x:o,y:n}}=t;return e.start(o,n)},[s.default.endPointLink]:(e,t)=>{const{payload:{x:o,y:n}}=t;return e.end(o,n)}},new r.PointLink)},296:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=o(83),a=o(65),i=o(30),s=(n=i)&&n.__esModule?n:{default:n};t.default=(0,a.handleActions)({[s.default.updateBlockCreator]:(e,t)=>{const{payload:o}=t;return e.merge(o)},[s.default.showBlockCreator]:(e,t)=>{const{payload:{x:o,y:n}}=t;return e.show(o,n)}},new r.BlockCreator)},30:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=o(376),a=(n=r)&&n.__esModule?n:{default:n},i=o(65),s=o(87);t.default=(0,i.createActions)({ADD_BLOCK:e=>(0,a.default)({id:s.generator.id()},e),UPDATE_BLOCK:(e,t)=>({id:e,patch:t}),DELTA_MOVE_BLOCK:(e,t,o)=>({id:e,dx:t,dy:o}),TOGGLE_BLOCK_CREATOR:(e,t)=>({x:e,y:t})},"DELETE_BLOCK","UPDATE_BLOCK_CREATOR","ADD_PIN","DELETE_PIN","START_POINT_LINK","END_POINT_LINK","ADD_PIN_LINK","REMOVE_PIN_LINK_BY_QUERY","ON_CHANGE_HTML","CLEAR_VIEW_BLOCK","PUSH_VIEW_BLOCK","SHOW_BLOCK_CREATOR","UPDATE_HANDWRITING","RESIZE_BLOCK")},302:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(84),r=o(83),a=o(65),i=l(o(30)),s=o(41),c=l(o(120));function l(e){return e&&e.__esModule?e:{default:e}}const{blue2:u,white0:d}=c.default;t.default=(0,a.handleActions)({[i.default.addBlock]:(e,t)=>{const{payload:o}=t;return e.push(new r.Block(o))},[i.default.updateBlock]:(e,t)=>{const{payload:{id:o,patch:n}}=t,r=e.findIndex(e=>e.get("id")===o);return e.update(r,e=>e.merge(n).set("handwriting",s.EMPTY_HANDWRITING))},[i.default.deleteBlock]:(e,t)=>{const{payload:o}=t,n=e.findIndex(e=>e.get("id")===o);return e.filter((e,t)=>t!==n)},[i.default.deltaMoveBlock]:(e,t)=>{const{payload:{id:o,dx:n,dy:r}}=t,a=e.findIndex(e=>e.get("id")===o);return e.update(a,e=>e.dmove(n,r))},[i.default.addPin]:(e,t)=>{const{payload:o}=t,n=e.findIndex(e=>e.get("id")===o);return e.update(n,e=>e.updateIn(["inputPins"],t=>t.push(e.createPin(e.type===s.BLOCK.TYPE_FUNCTION?u:d,s.PIN.TYPE_INPUT))).recalculateHeight())},[i.default.deletePin]:(e,t)=>{const{payload:{id:o}}=t,n=e.findIndex(e=>e.get("id")===o);return e.update(n,e=>e.updateIn(["inputPins"],e=>e.slice(0,Math.max(1,e.size-1))).recalculateHeight())},[i.default.clearViewBlock]:e=>e.update(0,e=>e.set("value","")),[i.default.pushViewBlock]:(e,t)=>{const{payload:o}=t;return e.update(0,e=>{const t=e.get("value");return e.set("value",t?`${t}\n${o}`:o)})},[i.default.updateHandwriting]:(e,t)=>{const{payload:{id:o,handwriting:n}}=t,r=e.findIndex(e=>e.get("id")===o),{flattenArgs:{length:a},expression:i}=n;return e.update(r,e=>{if(e.get("type")===s.BLOCK.TYPE_MATH){e=e.updateIn(["inputPins"],e=>e.clear());for(let t=0;t<a;t+=1)e=e.updateIn(["inputPins"],t=>t.push(e.createPin(d,s.PIN.TYPE_INPUT)))}return e.set("handwriting",n).set("value",i)})},[i.default.resizeBlock]:(e,t)=>{const{payload:{id:o,width:n,height:r}}=t,a=e.findIndex(e=>e.get("id")===o);return e.update(a,e=>e.resize(n,r))}},(0,n.List)())},303:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(173),r=l(o(302)),a=l(o(296)),i=l(o(295)),s=l(o(294)),c=l(o(293));function l(e){return e&&e.__esModule?e:{default:e}}t.default=(0,n.combineReducers)({blocks:r.default,blockCreator:a.default,pointLink:i.default,pinLinks:s.default,htmlEditor:c.default})},304:function(e,t,o){(t=e.exports=o(24)(!1)).push([e.i,".Chain__base_L0Lag {\n  background-color: #1e1e1e; }\n  .Chain__base_L0Lag > svg {\n    display: block;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    left: 0;\n    top: 0; }\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",base:"Chain__base_L0Lag"}},305:function(e,t,o){var n=o(304);"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};o(23)(n,r);n.locals&&(e.exports=n.locals)},318:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=d(o(317)),a=d(o(42)),i=d(o(181)),s=o(2),c=d(s),l=o(41),u=d(o(67));function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t,o,n,r){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}const h=l.PIN.RADIUS+1;let f=(p((n=class extends s.Component{constructor(){super(),this.state={enter:!1,connecting:!1}}onMouseDownOrTouchStart(e){const{props:{model:t,parent:o,onMouseDownOrTouchStart:n}}=this;n(e,t,o),document.addEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.addEventListener("touchend",this.onMouseUpOrTouchEndDocument),this.setState({connecting:!0})}onMouseup(e){const{props:{model:t,onMouseUpOrTouchEnd:o,parent:n}}=this;o(e,t,n)}onMouseEnter(){this.setState({enter:!0})}onMouseLeave(){this.setState({enter:!1})}onTouchEnd(e){const{pageX:t,pageY:o}=e.changedTouches.item(0);(0,i.default)(document.querySelectorAll("[data-pin]"),n=>{const{left:s,top:c,width:l,height:u}=n.getBoundingClientRect();return s<=t&&t<=s+l&&c<=o&&o<=c+u&&(0,i.default)((0,a.default)(n),t=>{if((0,r.default)(t,"__reactInternalInstance$")){const{memoizedProps:{_touchprops_:{onMouseUpOrTouchEnd:o}}}=n[t],r=function(e,t){var o={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(o[n]=e[n]);return o}(n[t].memoizedProps._touchprops_,["onMouseUpOrTouchEnd"]);return o(e,r),!0}return!1})})}onMouseUpOrTouchEndDocument(){document.removeEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.removeEventListener("touchend",this.onMouseUpOrTouchEndDocument),this.setState({connecting:!1})}render(){const{props:{model:e,onMouseUpOrTouchEnd:t,parent:o},state:{enter:n,connecting:r}}=this,a=e.get("color"),i=e.get("type");return c.default.createElement("svg",{"data-pin":!0,_touchprops_:{type:e.get("type"),index:e.get("index"),parent:o,onMouseUpOrTouchEnd:t},onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart,onMouseUp:this.onMouseup,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onTouchEnd:this.onTouchEnd,style:{position:"absolute",left:e.get("cx")-h,top:e.get("cy")-h,width:2*l.PIN.WIDTH,height:2*l.PIN.WIDTH,cursor:"pointer"}},c.default.createElement("circle",{cx:h,cy:h,r:l.PIN.S_RADIUS,fill:i===l.PIN.TYPE_INPUT?"none":i===l.PIN.TYPE_OUTPUT?a:"red",stroke:a}),n||r||e.get("linked")?c.default.createElement("circle",{cx:h,cy:h,r:l.PIN.RADIUS,fill:"none",stroke:a}):null)}}).prototype,"onMouseDownOrTouchStart",[u.default],Object.getOwnPropertyDescriptor(n.prototype,"onMouseDownOrTouchStart"),n.prototype),p(n.prototype,"onMouseup",[u.default],Object.getOwnPropertyDescriptor(n.prototype,"onMouseup"),n.prototype),p(n.prototype,"onMouseEnter",[u.default],Object.getOwnPropertyDescriptor(n.prototype,"onMouseEnter"),n.prototype),p(n.prototype,"onMouseLeave",[u.default],Object.getOwnPropertyDescriptor(n.prototype,"onMouseLeave"),n.prototype),p(n.prototype,"onTouchEnd",[u.default],Object.getOwnPropertyDescriptor(n.prototype,"onTouchEnd"),n.prototype),p(n.prototype,"onMouseUpOrTouchEndDocument",[u.default],Object.getOwnPropertyDescriptor(n.prototype,"onMouseUpOrTouchEndDocument"),n.prototype),n);t.default=f},319:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=l(o(78)),a=o(2),i=l(a),s=o(48),c=l(o(182));function l(e){return e&&e.__esModule?e:{default:e}}let u=(0,s.connect)(({blocks:e})=>({blocks:e}))(n=class extends a.Component{render(){const{props:{blocks:e,model:t}}=this,o=[];return(0,r.default)(["output","input"],n=>{const r=e.find(e=>e.get("id")===t.getIn([n,"block"])).getIn([`${n}Pins`,t.getIn([n,"pin"])]);o.push(r.get("cx"),r.get("cy"))}),i.default.createElement(c.default,{points:o})}})||n;t.default=u},320:function(e,t,o){(t=e.exports=o(24)(!1)).push([e.i,"\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa"}},321:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(o(2)),r=a(o(182));function a(e){return e&&e.__esModule?e:{default:e}}t.default=(e=>{const{model:t}=e;return n.default.createElement(r.default,{points:t.points(),strokeDasharray:[5,5]})})},322:function(e,t,o){(t=e.exports=o(24)(!1)).push([e.i,'.BlockCreator__shadow_Y8igC, .BlockCreator__base_1ZSFp {\n  box-shadow: 0 3px 3px 0 rgba(0, 0, 0, 0.14), 0 1px 7px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -1px rgba(0, 0, 0, 0.2); }\n\n.BlockCreator__base_1ZSFp {\n  background-color: #1e1e1e;\n  border: 1px solid #2b2b2b;\n  color: #d4d4d4;\n  width: 200px;\n  padding: 10px;\n  box-sizing: border-box;\n  font-family: Menlo, Monaco, "Courier New", monospace;\n  font-size: 12px; }\n  .BlockCreator__base_1ZSFp select {\n    display: block;\n    background-color: #2b2b2b;\n    color: inherit;\n    width: 100%;\n    border: 1px solid transparent;\n    margin-bottom: 5px;\n    font: inherit;\n    outline: none;\n    -webkit-appearance: none;\n    padding: 2px 4px; }\n    .BlockCreator__base_1ZSFp select:focus {\n      border-color: #007acc; }\n  .BlockCreator__base_1ZSFp textarea {\n    width: 100%;\n    background-color: #2b2b2b;\n    font: inherit;\n    color: inherit;\n    height: 100%;\n    box-sizing: border-box;\n    resize: vertical;\n    outline: none;\n    display: block;\n    margin-bottom: 5px;\n    border: 1px solid transparent;\n    border-radius: 0; }\n    .BlockCreator__base_1ZSFp textarea:focus {\n      border-color: #007acc; }\n  .BlockCreator__base_1ZSFp button {\n    display: inline-block;\n    background-color: #2b2b2b;\n    color: inherit;\n    border-radius: 4px;\n    font: inherit;\n    border: none;\n    outline: none;\n    cursor: pointer; }\n',""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",shadow:"BlockCreator__shadow_Y8igC",base:"BlockCreator__base_1ZSFp"}},323:function(e,t,o){var n=o(322);"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};o(23)(n,r);n.locals&&(e.exports=n.locals)},332:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=_(o(331)),i=_(o(97)),s=o(2),c=_(s),l=o(79),u=o(48),d=_(o(30)),p=o(41),h=o(121),f=_(o(67));function _(e){return e&&e.__esModule?e:{default:e}}function b(e,t,o,n,r){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}o(323);const g=(0,i.default)(p.BLOCK.CREATABLE_BLOCK_LIST,e=>`${(0,a.default)(e)} Block`);let m=(0,u.connect)()((b((r=class extends s.Component{componentWillUpdate(e){const{model:t}=e,{props:{model:o}}=this;!o.get("visible")&&t.get("visible")&&(document.addEventListener("mousedown",this.onMouseDownOrTouchStartDocument),document.addEventListener("touchstart",this.onMouseDownOrTouchStartDocument))}onClick(){const{props:{model:e,dispatch:t}}=this;document.removeEventListener("mousedown",this.onMouseDownOrTouchStartDocument),document.removeEventListener("touchstart",this.onMouseDownOrTouchStartDocument),t((0,h.batchActions)([d.default.addBlock({x:e.get("x"),y:e.get("y"),type:e.get("selected")}),d.default.updateBlockCreator({visible:!1})]))}onChangeSelect(e){const{currentTarget:{value:t}}=e,{props:{dispatch:o}}=this;o(d.default.updateBlockCreator({selected:t}))}onMouseDownOrTouchStartDocument(e){const{target:t}=e,{props:{dispatch:o}}=this,n=(0,l.findDOMNode)(this);n&&!n.contains(t)&&(o(d.default.updateBlockCreator({visible:!1})),document.removeEventListener("mousedown",this.onMouseDownOrTouchStartDocument),document.removeEventListener("touchstart",this.onMouseDownOrTouchStartDocument))}render(){const{props:{model:e}}=this;return e.get("visible")?c.default.createElement("div",{className:"BlockCreator__base_1ZSFp",style:{position:"absolute",left:e.get("x"),top:e.get("y")}},c.default.createElement("select",{value:e.get("selected"),onChange:this.onChangeSelect},(0,i.default)(p.BLOCK.CREATABLE_BLOCK_LIST,(e,t)=>c.default.createElement("option",{value:e,key:t},g[t]))),c.default.createElement("button",{onClick:this.onClick},"ADD")):null}}).prototype,"onClick",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onClick"),r.prototype),b(r.prototype,"onChangeSelect",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onChangeSelect"),r.prototype),b(r.prototype,"onMouseDownOrTouchStartDocument",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseDownOrTouchStartDocument"),r.prototype),n=r))||n;t.default=m},334:function(e,t,o){(t=e.exports=o(24)(!1)).push([e.i,'.Block__shadow_2-4hx, .Block__base_3ulp8 {\n  box-shadow: 0 3px 3px 0 rgba(0, 0, 0, 0.14), 0 1px 7px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -1px rgba(0, 0, 0, 0.2); }\n\n.Block__tag-base_3eap6, .Block__base_3ulp8 button, .Block__tag_2g7gc {\n  display: inline-block;\n  color: inherit;\n  border: none;\n  font: inherit;\n  padding: 1px 8px;\n  background-color: #2b2b2b;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  margin: 0; }\n  .Block__tag-base_3eap6:not(:first-child), .Block__base_3ulp8 button:not(:first-child), .Block__tag_2g7gc:not(:first-child) {\n    margin-left: 1px; }\n\n.Block__base_3ulp8 {\n  font-size: 12px;\n  color: #d4d4d4;\n  border: 1px solid #2b2b2b;\n  background-color: #1e1e1e;\n  box-sizing: border-box;\n  font-family: Menlo, Monaco, "Courier New", monospace;\n  display: flex;\n  flex-direction: column;\n  position: relative; }\n  .Block__base_3ulp8 button {\n    cursor: pointer;\n    outline: none; }\n  .Block__base_3ulp8 textarea {\n    width: 100%;\n    border: none;\n    background-color: #2b2b2b;\n    font: inherit;\n    color: inherit;\n    height: 100%;\n    box-sizing: border-box;\n    resize: none;\n    outline: none;\n    display: block;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    border-radius: 0; }\n\n.Block__math_2WDqM {\n  background-color: #2b2b2b;\n  height: calc(100% - 23px);\n  width: 100%; }\n\n.Block__math-arg_3aTuw {\n  position: absolute;\n  background-color: #2b2b2b;\n  width: 20px;\n  left: 2px;\n  text-align: center; }\n\n.Block__textarea-div_19vCU, .Block__math-div_2fcEH {\n  height: calc(100% - 16px);\n  padding: 5px;\n  box-sizing: border-box;\n  position: relative; }\n  .Block__textarea-div_19vCU input, .Block__math-div_2fcEH input {\n    border: none;\n    background-color: #2b2b2b;\n    font-size: inherit;\n    color: #d4d4d4;\n    width: 100%;\n    outline: none;\n    box-sizing: border-box;\n    margin-bottom: 5px;\n    font-family: Menlo, Monaco, "Courier New", monospace;\n    padding: 2px; }\n\n.Block__math-div_2fcEH {\n  padding-left: 24px; }\n\n.Block__red_1kUYK {\n  background-color: #f44336 !important; }\n\n.Block__resizer_2BB8h {\n  background-color: transparent;\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  width: 5px;\n  height: 5px;\n  cursor: nwse-resize; }\n\n.ms-editor .loader {\n  width: 100px !important;\n  height: 100px !important;\n  top: calc(50% - 65px) !important;\n  left: calc(50% - 65px) !important; }\n\n#MODEL-viewTransform {\n  stroke: #d4d4d4; }\n\n.smartguide {\n  display: none; }\n\n#BACKGROUND-guides * {\n  stroke: none; }\n',""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",white1:"#c7c7c7",shadow:"Block__shadow_2-4hx",base:"Block__base_3ulp8","tag-base":"Block__tag-base_3eap6",tag:"Block__tag_2g7gc",math:"Block__math_2WDqM","math-arg":"Block__math-arg_3aTuw","textarea-div":"Block__textarea-div_19vCU","math-div":"Block__math-div_2fcEH",red:"Block__red_1kUYK",resizer:"Block__resizer_2BB8h"}},335:function(e,t,o){var n=o(334);"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};o(23)(n,r);n.locals&&(e.exports=n.locals)},338:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(o(126)),r=a(o(78));function a(e){return e&&e.__esModule?e:{default:e}}var i,s,c,l,u,d,p,h,f,_,b;t.default=(e=>{const t=(e=e,s=function(){var t=e;return t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\s/g,"")).replace(/\\times/g,"*")).replace(/\\cdot/g,"*")).replace(/\\div/g,"/")).replace(/([0-9]+)([a-zA-Z]+)/g,"$1*$2")).replace(/([0-9a-zA-Z\.]+)\\pi/g,"$1*Math.PI")).replace(/\\pi([0-9a-zA-Z\.]+)/g,"Math.PI*$1")).replace(/([0-9a-zA-Z\.]+)\\pi([0-9a-zA-Z\.]+)/g,"$1*Math.PI*$2")).replace(/\\pi/g,"Math.PI"),t=c(t),t=l(t),t=u(t),t=d(t),t=p(t),t=f(t),t=(t=(t=(t=(t=(t=h(t)).replace(/\\left\(/g,"(")).replace(/\\right\)/g,")")).replace(/([0-9a-zA-Z\.]+)\Math/g,"$1*Math")).replace(/\)Math/g,")*Math")).replace(/\)([0-9a-zA-Z\.]+)/g,")*$1")},c=function(e){for(;e.search(/\\frac\{(((?![\{\}]).)*)\}\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\frac\{(((?![\{\}]).)*)\}\{(((?![\{\}]).)*)\}/g,"($1)/($3)");for(;e.search(/\\dfrac\{(((?![\{\}]).)*)\}\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\dfrac\{(((?![\{\}]).)*)\}\{(((?![\{\}]).)*)\}/g,"($1)/($3)");return e.search(/\\frac/)>=0&&(e=b("fraction",e)),e.search(/\\dfrac/)>=0&&(e=b("fraction",e)),e},l=function(e){for(;e.search(/\\sqrt\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\sqrt\{(((?![\{\}]).)*)\}/g,"Math.sqrt($1)");return e.search(/\\sqrt\{/)>=0&&(e=b("square root",e)),e},u=function(e){for(;e.search(/\\sqrt\[(((?![\{\}]).)*)\]\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\sqrt\[(((?![\{\}]).)*)\]\{(((?![\{\}]).)*)\}/g,"Math.pow($3,1/$1)");return e.search(/\\sqrt\[/)>=0&&(e=b("nth root",e)),e},d=function(e){for(;e.search(/([0-9a-zA-Z\.]+)\^\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/([0-9a-zA-Z\.]+)\^\{(((?![\{\}]).)*)\}/g,"Math.pow($1,$2)");for(;e.search(/([0-9a-zA-Z\.]+)\^([0-9a-zA-Z\.]+)/)>=0;)e=e.replace(/([0-9a-zA-Z\.]+)\^([0-9a-zA-Z\.]+)/g,"Math.pow($1,$2)");for(;e.search(/\\left\(([0-9a-zA-Z\.\+\*\-\\]+)\\right\)\^([0-9a-zA-Z\.]+)/)>=0;)e=e.replace(/\\left\(([0-9a-zA-Z\.\+\*\-\\]+)\\right\)\^([0-9a-zA-Z\.]+)/g,"Math.pow($1,$2)");for(;e.search(/\\left\(([0-9a-zA-Z\.\+\*\-\\]+)\\right\)\^\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\left\(([0-9a-zA-Z\.\+\*\-\\]+)\\right\)\^\{(((?![\{\}]).)*)\}/g,"Math.pow($1,$2)");for(;e.search(/\\left\(([0-9a-zA-Z\.\+\*\-\\\(\)\/]+)\\right\)\^\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\left\(([0-9a-zA-Z\.\+\*\-\\\(\)\/]+)\\right\)\^\{(((?![\{\}]).)*)\}/g,"Math.pow($1,$2)");return e.search(/\^/)>=0&&(e=b("nth power",e)),e},p=function(e){return _("sin",e)},f=function(e){return _("tan",e)},h=function(e){return _("cos",e)},_=function(e,t){for(var o=/\\sin\\left\(([0-9a-zA-Z\.\+\*\-\\\(\)\/]+)\\right\)/;t.search(o)>=0;)t=t.replace(o,"Math."+e+"($1)");for(var n=new RegExp("\\\\"+e+"([0-9a-zA-Z]+)");t.search(n)>=0;)t=t.replace(n,"Math."+e+"($1)");var r=new RegExp("\\\\"+e);return t.search(r)>=0&&(t=b(e,t)),t},b=function(e,t){var o,n,r,a,i,s,_,b,g,m;switch(e){case"fraction":(o=t.match(/\\frac.*/)[0]).search(/\\frac/);break;case"square root":(o=t.match(/\\sqrt\{.*/)[0]).search(/\\sqrt\{/);break;case"nth root":(o=t.match(/\\sqrt\[.*/)[0]).search(/\\sqrt\[/);break;case"nth power":(o=t.match(/\^.*/)[0]).search(/\^/);break;case"sin":console.log(t),console.log(t.match(/\\sin\{.*/)),(o=t.match(/\\sin\{.*/)[0]).search(/\\sin\{/);break;case"tan":(o=t.match(/\\tan\{.*/)[0]).search(/\\tan\{/);break;case"cos":(o=t.match(/\\cos\{.*/)[0]).search(/\\cos\{/);break;default:return}if(a=o.search(/\\frac/),i=o.search(/\\sqrt\{/),(n=[a,s=o.search(/\\sqrt\[/),i,_=o.search(/\^/),b=o.search(/\\sin\{/),m=o.search(/\\tan\{/),g=o.search(/\\cos\{/)]).sort(function(e,t){return t-e}),(r=n[n.indexOf(0)-1])<=0||void 0===r)throw"syntax error";switch(r){case a:t=c(t);break;case i:t=l(t);break;case s:t=u(t);break;case _:t=d(t);break;case b:t=p(t);break;case m:t=f(t);break;case g:t=h(t)}switch(e){case"fraction":t=c(t);break;case"square root":t=l(t);break;case"nth root":t=u(t);break;case"nth power":t=d(t);break;case"sin":t=p(t);break;case"tan":t=f(t);break;case"cos":t=h(t)}return t},s()),o=(e=>{const{length:t}=e,o=[];for(let n=0;n<t;n+=1){const t=e[n-1]||"",r=e[n]||"",a=e[n+1]||"";/\.|[A-Za-z]/.test(t)||!/[A-Za-z]/.test(r)||/\.|[A-Za-z]/.test(a)||o.push({index:n,char:r})}return o})(t),a=[];return(0,r.default)(o,({char:e})=>{(0,n.default)(a,e)||a.push(e)}),{expression:t,args:o,flattenArgs:a}})},340:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TYPE_OUTPUT="OUTPUT_PIN",t.TYPE_INPUT="INPUT_PIN",t.RADIUS=7,t.S_RADIUS=4,t.WIDTH=8},341:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WIDTH=200,t.HEIGHT=70;const n=t.TYPE_VALUE="VALUE",r=t.TYPE_FUNCTION="FUNCTION",a=t.TYPE_PROPERTY="PROPERTY",i=t.TYPE_OPERATOR="OPERATOR",s=(t.TYPE_VIEW="VIEW",t.TYPE_MATH="MATH");t.TYPE_TIMER="TIMER",t.CREATABLE_BLOCK_LIST=[n,r,a,i,s]},358:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=u(o(357)),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},i=o(2),s=u(i),c=u(o(79)),l=u(o(67));function u(e){return e&&e.__esModule?e:{default:e}}let d=(p=(n=class extends i.Component{constructor(){super(),this.tab=!1,this.selectionStart=-1}componentDidUpdate(){const{selectionStart:e}=this;if(-1<e){const t=e+1;c.default.findDOMNode(this).setSelectionRange(t,t)}this.selectionStart=-1}onKeyDown(...e){const{props:{onKeyDown:t}}=this,{keyCode:o,currentTarget:{selectionStart:n}}=e[0];9===o&&(this.selectionStart=n),"function"==typeof t&&t(...e)}render(){const{props:e}=this,t=(0,r.default)(e);return delete t.onKeyDown,s.default.createElement("textarea",a({},t,{onKeyDown:this.onKeyDown}))}}).prototype,h="onKeyDown",f=[l.default],_=Object.getOwnPropertyDescriptor(n.prototype,"onKeyDown"),b=n.prototype,g={},Object.keys(_).forEach(function(e){g[e]=_[e]}),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=f.slice().reverse().reduce(function(e,t){return t(p,h,e)||e},g),b&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(b):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(p,h,g),g=null),n);var p,h,f,_,b,g;t.default=d},41:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_HANDWRITING=t.PIN=t.BLOCK=void 0;var n=a(o(341)),r=a(o(340));function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}t.BLOCK=n,t.PIN=r,t.EMPTY_HANDWRITING={expression:"",args:[],flattenArgs:[]}},439:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=P(o(97)),i=P(o(126)),s=P(o(195)),c=o(2),l=P(c),u=o(48),d=P(o(30)),p=P(o(67)),h=P(o(358)),f=o(87),_=o(41),b=P(o(339)),g=P(o(338)),m=P(o(337)),v=P(o(336)),y=P(o(335));function P(e){return e&&e.__esModule?e:{default:e}}function E(e,t,o,n,r){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}window.ontouchmove=(()=>{});const{white1:O}=y.default;let T=(0,u.connect)()((E((r=class extends c.Component{constructor(){super(),this._prevX=0,this._prevY=0,this._startX=0,this._startY=0,this._startWidth=0,this._startHeight=0,this._editor=l.default.createRef(),this._canClearMathEditor=!0}componentDidMount(){const{props:{model:e},_editor:{current:t}}=this,o=e.get("type");t&&(t.addEventListener("exported",this.onExported),b.default.register(t,{recognitionParams:{type:o===_.BLOCK.TYPE_MATH||o===_.BLOCK.TYPE_VALUE||o===_.BLOCK.TYPE_OPERATOR?"MATH":"TEXT",apiVersion:"V4",server:{applicationKey:"331b4bdf-7ace-4265-94f1-b01504c78743",hmacKey:"44f4f4ce-fd0f-48a1-b517-65d2b9465413"},v4:{math:{mimeTypes:["application/x-latex"]}}}},{},{ink:{color:O}}))}onExported(e){const{props:{model:t,dispatch:o},_canClearMathEditor:n}=this,{detail:{exports:r}}=e;n&&o(d.default.updateHandwriting({id:t.get("id"),handwriting:(0,g.default)(void 0===r?"":r["application/x-latex"]||r["text/plain"]||"")})),this._canClearMathEditor=!0}clearMathEditor(){const{_editor:{current:{editor:e}}}=this;e.clear()}undoMathEditor(){const{_editor:{current:{editor:e}}}=this;e.undo()}redoMathEditor(){const{_editor:{current:{editor:e}}}=this;e.redo()}onChange(e){const{props:{model:t,dispatch:o},_editor:{current:n}}=this,{currentTarget:{value:r}}=e;if(this._canClearMathEditor=!1,o(d.default.updateBlock(t.get("id"),{value:r})),n){const{editor:e}=n;e.clear()}}onClickDeleteButton(){const{props:{model:e,dispatch:t}}=this,o=e.get("id");t(d.default.deleteBlock(o))}onMouseDownOrTouchStart(e){const{target:{dataset:t}}=e;if((0,s.default)(t,"draggable")){const{pageX:t,pageY:o}=(0,f.getMouseOrFirstTouchPosition)(e);this._prevX=t,this._prevY=o,document.body.classList.add("move"),document.addEventListener("mousemove",this.onMouseMoveOrTouchMoveDocument,{passive:!0}),document.addEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.addEventListener("touchmove",this.onMouseMoveOrTouchMoveDocument,{passive:!0}),document.addEventListener("touchend",this.onMouseUpOrTouchEndDocument)}}onMouseMoveOrTouchMoveDocument(e){const{pageX:t,pageY:o}=(0,f.getMouseOrFirstTouchPosition)(e),{props:{model:n,dispatch:r},_prevX:a,_prevY:i}=this;r(d.default.deltaMoveBlock(n.get("id"),t-a,o-i)),this._prevX=t,this._prevY=o}onMouseUpOrTouchEndDocument(){document.body.classList.remove("move"),document.removeEventListener("mousemove",this.onMouseMoveOrTouchMoveDocument),document.removeEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.removeEventListener("touchmove",this.onMouseMoveOrTouchMoveDocument),document.removeEventListener("touchend",this.onMouseUpOrTouchEndDocument)}addPin(){const{props:{model:e,dispatch:t}}=this;t(d.default.addPin(e.get("id")))}deletePin(){const{props:{model:e,dispatch:t}}=this;t(d.default.deletePin({id:e.get("id"),removed:e.get("inputPins").size-1}))}onKeyDown(e){const{keyCode:t,currentTarget:{selectionStart:o,selectionEnd:n}}=e,{props:{dispatch:r,model:a}}=this;if(9===t){e.preventDefault();const t=a.get("value");r(d.default.updateBlock(a.get("id"),{value:`${t.substring(0,o)}\t${t.substring(n)}`}))}}onResizeMouseDownOrTouchStart(e){const{props:{model:t}}=this,{pageX:o,pageY:n}=(0,f.getMouseOrFirstTouchPosition)(e);this._startX=o,this._startY=n,this._startWidth=t.get("width"),this._startHeight=t.get("height"),document.body.classList.add("nwse-resize"),document.body.addEventListener("mousemove",this.onResizeMouseMoveOrTouchMoveDoc),document.body.addEventListener("touchmove",this.onResizeMouseMoveOrTouchMoveDoc),document.body.addEventListener("mouseup",this.onResizeMouseUpDoc),document.body.addEventListener("touchend",this.onResizeMouseUpDoc)}onResizeMouseMoveOrTouchMoveDoc(e){const{_startX:t,_startY:o,_startWidth:n,_startHeight:r,_editor:{current:a},props:{dispatch:i,model:s}}=this,{pageX:c,pageY:l}=(0,f.getMouseOrFirstTouchPosition)(e);if(i(d.default.resizeBlock({width:n+(c-t),height:r+(l-o),id:s.get("id")})),a){const{editor:e}=a;e.resize()}}onResizeMouseUpDoc(){document.body.classList.remove("nwse-resize"),document.body.removeEventListener("mousemove",this.onResizeMouseMoveOrTouchMoveDoc),document.body.removeEventListener("touchmove",this.onResizeMouseMoveOrTouchMoveDoc),document.body.removeEventListener("mouseup",this.onResizeMouseUpDoc),document.body.removeEventListener("touchend",this.onResizeMouseUpDoc)}render(){const{props:{model:e}}=this,t=e.get("color"),o=e.get("type"),{flattenArgs:n}=e.get("handwriting");return l.default.createElement("div",{"data-draggable":!0,className:"Block__base_3ulp8",onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart,style:{position:"absolute",left:e.get("x"),top:e.get("y"),width:e.get("width"),height:e.get("height")}},l.default.createElement("div",{"data-draggable":!0},e.get("deletable")?l.default.createElement("button",{className:"Block__red_1kUYK",onClick:this.onClickDeleteButton},"x"):null,e.get("changeable")?l.default.createElement(c.Fragment,null,l.default.createElement("button",{onClick:this.addPin},"+"),l.default.createElement("button",{onClick:this.deletePin},"-")):null,o===_.BLOCK.TYPE_TIMER?l.default.createElement("div",{className:"Block__tag_2g7gc"},"FPS"):null,(0,i.default)(_.BLOCK.CREATABLE_BLOCK_LIST,o)?l.default.createElement(c.Fragment,null,l.default.createElement("button",{onClick:this.clearMathEditor},"Clear"),l.default.createElement("button",{onClick:this.undoMathEditor},l.default.createElement(m.default,null)),l.default.createElement("button",{onClick:this.redoMathEditor},l.default.createElement(v.default,null))):null),(0,i.default)(_.BLOCK.CREATABLE_BLOCK_LIST,o)?l.default.createElement("div",{"data-draggable":!0,className:"Block__math-div_2fcEH"},l.default.createElement("input",{type:"text",readOnly:!e.get("editable"),value:e.get("value"),onChange:this.onChange,style:{borderLeft:`5px solid ${t}`}}),(0,a.default)(n,(e,t)=>l.default.createElement("div",{className:"Block__math-arg_3aTuw",key:t,style:{top:2*_.PIN.WIDTH*t+6}},e)),l.default.createElement("div",{className:"Block__math_2WDqM",ref:this._editor})):l.default.createElement("div",{"data-draggable":!0,className:"Block__textarea-div_19vCU"},l.default.createElement(h.default,{readOnly:!e.get("editable"),onChange:this.onChange,value:e.get("value"),spellCheck:!1,style:{borderLeft:`5px solid ${t}`},onKeyDown:this.onKeyDown})),e.get("resizable")?l.default.createElement("div",{className:"Block__resizer_2BB8h",onMouseDown:this.onResizeMouseDownOrTouchStart,onTouchStart:this.onResizeMouseDownOrTouchStart}):null)}}).prototype,"onExported",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onExported"),r.prototype),E(r.prototype,"clearMathEditor",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"clearMathEditor"),r.prototype),E(r.prototype,"undoMathEditor",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"undoMathEditor"),r.prototype),E(r.prototype,"redoMathEditor",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"redoMathEditor"),r.prototype),E(r.prototype,"onChange",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onChange"),r.prototype),E(r.prototype,"onClickDeleteButton",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onClickDeleteButton"),r.prototype),E(r.prototype,"onMouseDownOrTouchStart",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseDownOrTouchStart"),r.prototype),E(r.prototype,"onMouseMoveOrTouchMoveDocument",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseMoveOrTouchMoveDocument"),r.prototype),E(r.prototype,"onMouseUpOrTouchEndDocument",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseUpOrTouchEndDocument"),r.prototype),E(r.prototype,"addPin",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"addPin"),r.prototype),E(r.prototype,"deletePin",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"deletePin"),r.prototype),E(r.prototype,"onKeyDown",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyDown"),r.prototype),E(r.prototype,"onResizeMouseDownOrTouchStart",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onResizeMouseDownOrTouchStart"),r.prototype),E(r.prototype,"onResizeMouseMoveOrTouchMoveDoc",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onResizeMouseMoveOrTouchMoveDoc"),r.prototype),E(r.prototype,"onResizeMouseUpDoc",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onResizeMouseUpDoc"),r.prototype),n=r))||n;t.default=T},452:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r,a=y(o(78)),i=o(2),s=y(i),c=o(48),l=y(o(439)),u=y(o(332)),d=y(o(30)),p=y(o(321)),h=y(o(319)),f=y(o(67)),_=y(o(318)),b=o(41),g=o(121),m=o(87),v=o(180);function y(e){return e&&e.__esModule?e:{default:e}}function P(e,t,o,n,r){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=o.slice().reverse().reduce(function(o,n){return n(e,t,o)||o},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}o(305),window.ontouchmove=(()=>{});let E=(0,c.connect)(({blocks:e,pointLink:t,pinLinks:o,blockCreator:n})=>({blocks:e,link:t,links:o,blockCreator:n}))((P((r=class e extends i.Component{static convertPinTypeToPinLinkKey(e){switch(e){case b.PIN.TYPE_OUTPUT:return"output";case b.PIN.TYPE_INPUT:return"input";default:throw new Error("Unknown pin type")}}static get _isFrontmost(){const{location:{hash:e}}=document;return"#/chain"===e}constructor(){super(),this.state={frontmost:e._isFrontmost},window.addEventListener("hashchange",this.onHashChange)}componentDidMount(){window.addEventListener("message",this.onMessage)}componentWillUnmount(){window.removeEventListener("message",this.onMessage)}onHashChange(){this.setState({frontmost:e._isFrontmost})}onConnectStart(e,t,o){const{props:{dispatch:n}}=this,r=t.get("type"),a=t.get("index"),i=[d.default.startPointLink({x:t.get("cx"),y:t.get("cy")})];document.addEventListener("mousemove",this.onConnecting),document.addEventListener("mouseup",this.onConnectEnd),document.addEventListener("touchmove",this.onConnecting),document.addEventListener("touchend",this.onConnectEnd),window.__connection__={block:o,pin:a,pinType:r},r===b.PIN.TYPE_INPUT&&i.push(d.default.removePinLinkByQuery({input:{block:o,pin:a}})),n((0,g.batchActions)(i))}onConnecting(e){const{props:{dispatch:t}}=this,{clientX:o,clientY:n}=(0,m.getMouseOrFirstTouchPosition)(e);t(d.default.endPointLink({x:o,y:n}))}onConnectEnd(){const{props:{dispatch:e}}=this;e(d.default.startPointLink({x:0,y:0})),document.removeEventListener("mousemove",this.onConnecting),document.removeEventListener("mouseup",this.onConnectEnd),document.removeEventListener("touchmove",this.onConnecting),document.removeEventListener("touchend",this.onConnectEnd)}onConnectPin(t,o){const{__connection__:{block:n,pin:r,pinType:a}}=window,{props:{dispatch:i}}=this,{index:s,type:c,parent:l}=o;n!==l&&a!==c&&i(d.default.addPinLink({[e.convertPinTypeToPinLinkKey(a)]:{block:n,pin:r},[e.convertPinTypeToPinLinkKey(c)]:{block:l,pin:s}}))}onMessage(e){const{props:{dispatch:t}}=this,{data:{type:o,value:n}}=e;"chain-result"===o?t(d.default.pushViewBlock(JSON.stringify(n))):"chain-error"===o?v.toast.error(n,{position:v.toast.POSITION.BOTTOM_RIGHT}):"chain-clear"===o&&t(d.default.clearViewBlock())}onMouseDownOrTouchStart(e){const{target:t,currentTarget:o}=e,{clientX:n,clientY:r}=(0,m.getMouseOrFirstTouchPosition)(e),{props:{dispatch:a}}=this;t===o&&a(d.default.showBlockCreator({x:n,y:r}))}render(){const{props:{link:e,links:t,blockCreator:o},state:{frontmost:n}}=this;let{props:{blocks:r}}=this;return s.default.createElement("div",{className:"Chain__base_L0Lag",style:{visibility:n?"visible":"hidden"}},s.default.createElement("svg",{onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart},t.map((e,t)=>((0,a.default)(["input","output"],t=>{const o=r.findIndex(o=>o.get("id")===e.getIn([t,"block"]));r=r.setIn([o,`${t}Pins`,e.getIn([t,"pin"]),"linked"],!0)}),s.default.createElement(h.default,{key:t,model:e}))),s.default.createElement(p.default,{model:e})),r.map(e=>{const t=e.get("id");return[s.default.createElement(l.default,{key:t,model:e}),e.get("inputPins").map(e=>s.default.createElement(_.default,{key:e.get("index"),model:e,parent:t,onMouseDownOrTouchStart:this.onConnectStart,onMouseUpOrTouchEnd:this.onConnectPin})),e.get("outputPins").map(e=>s.default.createElement(_.default,{key:e.get("index"),model:e,parent:t,onMouseDownOrTouchStart:this.onConnectStart,onMouseUpOrTouchEnd:this.onConnectPin}))]}),s.default.createElement(u.default,{model:o}))}}).prototype,"onHashChange",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onHashChange"),r.prototype),P(r.prototype,"onConnectStart",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onConnectStart"),r.prototype),P(r.prototype,"onConnecting",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onConnecting"),r.prototype),P(r.prototype,"onConnectEnd",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onConnectEnd"),r.prototype),P(r.prototype,"onConnectPin",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onConnectPin"),r.prototype),P(r.prototype,"onMessage",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onMessage"),r.prototype),P(r.prototype,"onMouseDownOrTouchStart",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseDownOrTouchStart"),r.prototype),n=r))||n;t.default=E},455:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(2),r=g(n),a=o(48),i=g(o(452)),s=o(173),c=g(o(303)),l=o(121),u=o(262),d=g(o(290)),p=g(o(285)),h=g(o(30)),f=o(180),_=o(41),b=g(o(270));function g(e){return e&&e.__esModule?e:{default:e}}const{link:m,active:v}=b.default,y=(0,s.createStore)((0,l.enableBatching)(c.default));y.dispatch(h.default.addBlock({x:innerWidth/2+50,y:(innerHeight-_.BLOCK.HEIGHT)/2,type:_.BLOCK.TYPE_VIEW})),y.dispatch(h.default.addBlock({x:innerWidth/2-_.BLOCK.WIDTH-50,y:(innerHeight-_.BLOCK.HEIGHT)/2,type:_.BLOCK.TYPE_TIMER}));const P=()=>r.default.createElement(u.Redirect,{to:"/chain"});t.default=class extends n.Component{render(){return r.default.createElement(a.Provider,{store:y},r.default.createElement(u.HashRouter,null,r.default.createElement("div",{className:"App__wrap_1SQHV"},r.default.createElement("div",{className:"App__base_2Rw2G"},r.default.createElement(d.default,null),r.default.createElement(i.default,null),r.default.createElement(u.Route,{exact:!0,path:"/",render:P}),r.default.createElement(u.Route,{path:"/editor",component:p.default})),r.default.createElement("footer",null,r.default.createElement(u.NavLink,{to:"/chain",className:m,activeClassName:v},r.default.createElement("span",null,"Chain")),r.default.createElement(u.NavLink,{to:"/editor",className:m,activeClassName:v},r.default.createElement("span",null,"Editor")),r.default.createElement(u.NavLink,{to:"/view",className:m,activeClassName:v},r.default.createElement("span",null,"View"))),r.default.createElement(f.ToastContainer,{autoClose:3e3}))))}}},464:function(e,t,o){"use strict";var n=i(o(2)),r=o(79),a=i(o(455));function i(e){return e&&e.__esModule?e:{default:e}}o(268),o(266),o(264),(0,r.render)(n.default.createElement(a.default,null),document.querySelector("main"))},667:function(e,t,o){o(666),e.exports=o(464)},83:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PinLink=t.PointLink=t.BlockCreator=t.Pin=t.Block=void 0;var n=h(o(301)),r=h(o(25)),a=h(o(181)),i=h(o(195)),s=h(o(78)),c=h(o(97)),l=h(o(297)),u=o(84),d=o(41),p=h(o(120));function h(e){return e&&e.__esModule?e:{default:e}}const{white0:f,purple0:_,blue1:b,yellow0:g}=p.default;t.Block=class e extends((0,u.Record)({id:0,value:"",x:0,y:0,width:d.BLOCK.WIDTH,height:d.BLOCK.HEIGHT,deletable:!0,editable:!0,resizable:!0,type:"",color:f,changeable:!0,outputPins:(0,u.List)(),inputPins:(0,u.List)(),handwriting:d.EMPTY_HANDWRITING})){constructor(e){super(e);const{type:t}=this;let o=null;switch(t){case d.BLOCK.TYPE_VIEW:o={editable:!1,deletable:!1,color:_,inputPins:this._createPins([f],d.PIN.TYPE_INPUT)};break;case d.BLOCK.TYPE_VALUE:o={changeable:!1,outputPins:this._createPins([_],d.PIN.TYPE_OUTPUT)};break;case d.BLOCK.TYPE_FUNCTION:o={color:b,inputPins:this._createPins([b],d.PIN.TYPE_INPUT),outputPins:this._createPins([_],d.PIN.TYPE_OUTPUT)};break;case d.BLOCK.TYPE_PROPERTY:o={changeable:!1,color:g,inputPins:this._createPins([f],d.PIN.TYPE_INPUT),outputPins:this._createPins([f],d.PIN.TYPE_OUTPUT)};break;case d.BLOCK.TYPE_OPERATOR:o={changeable:!1,inputPins:this._createPins([f,f],d.PIN.TYPE_INPUT),outputPins:this._createPins([f],d.PIN.TYPE_OUTPUT)};break;case d.BLOCK.TYPE_MATH:o={changeable:!1,editable:!1,outputPins:this._createPins([f],d.PIN.TYPE_OUTPUT)};break;case d.BLOCK.TYPE_TIMER:o={changeable:!1,deletable:!1,resizable:!1,outputPins:this._createPins([f],d.PIN.TYPE_OUTPUT),value:60};break;default:throw new Error(`Unknown type: ${t}.`)}return this.merge(o).recalculateHeight()}recalculateHeight(){const{type:e,height:t,inputPins:{size:o},outputPins:{size:n}}=this;let r=Math.max(t,Math.max(4,o+2,n+2)*(2*d.PIN.WIDTH+1)-1);return e!==d.BLOCK.TYPE_VIEW&&e!==d.BLOCK.TYPE_TIMER&&(r=Math.max(200,r)),this.set("height",r)}recalculatePinPosition(){const{inputPins:e,outputPins:t,x:o,y:n}=this;return this.merge({inputPins:e.map((e,t)=>{const[r,a]=this._pinPosition(t,d.PIN.TYPE_INPUT);return e.merge({cx:o+r,cy:n+a})}),outputPins:t.map((e,t)=>{const[r,a]=this._pinPosition(t,d.PIN.TYPE_OUTPUT);return e.merge({cx:o+r,cy:n+a})})})}dmove(e,t){const{x:o,y:n,inputPins:r,outputPins:a}=this;return this.merge({x:o+e,y:n+t,inputPins:r.map(o=>o.dmove(e,t)),outputPins:a.map(o=>o.dmove(e,t))})}resize(e,t){const{type:o}=this;return this.merge({width:Math.max(d.BLOCK.WIDTH,e),height:Math.max(o!==d.BLOCK.TYPE_VIEW?200:d.BLOCK.HEIGHT,t)}).recalculatePinPosition()}createPin(t,o,n=null){const{x:r,y:a}=this,i=e.convertPinTypeToPinKey(o),{size:s}=this.get(i),c=(0,l.default)(n)?s:n,[u,d]=this._pinPosition(c,o);return new m({index:c,color:t,type:o,cx:r+u,cy:a+d})}_createPins(t,o){const n=this.get(e.convertPinTypeToPinKey(o));return 0===n.size?(0,u.List)((0,c.default)(t,(e,t)=>this.createPin(e,o,t))):n}_pinPosition(e,t){const{width:o}=this;return[t===d.PIN.TYPE_INPUT?-d.PIN.RADIUS-2:t===d.PIN.TYPE_OUTPUT?o+d.PIN.RADIUS:0,21+d.PIN.RADIUS+(2*d.PIN.WIDTH+1)*e+1]}static convertPinTypeToPinKey(e){switch(e){case d.PIN.TYPE_OUTPUT:return"outputPins";case d.PIN.TYPE_INPUT:return"inputPins";default:throw new Error("Unknown pin type")}}};let m=t.Pin=class extends((0,u.Record)({index:0,color:f,type:"",linked:!1,cx:0,cy:0})){dmove(e,t){const{cx:o,cy:n}=this;return this.merge({cx:o+e,cy:n+t})}};t.BlockCreator=class extends((0,u.Record)({x:0,y:0,visible:!1,value:"",selected:d.BLOCK.TYPE_VALUE})){show(e,t){return this.merge({visible:!0,x:e,y:t,value:"",selected:d.BLOCK.TYPE_VALUE})}},t.PointLink=class extends((0,u.Record)({ax:0,ay:0,bx:0,by:0})){start(e,t){return this.merge({ax:e,ay:t,bx:e,by:t})}end(e,t){return this.merge({bx:e,by:t})}points(){const{ax:e,ay:t,bx:o,by:n}=this;return[e,t,o,n]}},t.PinLink=class e extends((0,u.Record)({output:(0,u.Map)({block:0,pin:0}),input:(0,u.Map)({block:0,pin:0})})){constructor(e){(0,s.default)(["output","input"],t=>{(0,i.default)(e,t)&&(e[t]=(0,u.Map)(e[t]))}),super(e)}hasBlock(e){return(0,a.default)(["output","input"],t=>this.getIn([t,"block"])===e)}match({output:t,input:o}){return e._matcher(this.get("output"),t)&&e._matcher(this.get("input"),o)}static _matcher(t,o){return(0,r.default)(o)?!(0,a.default)((0,n.default)(o),([o,n])=>!e._matcher(t.get(o),n)):void 0!==t&&(void 0===o||t===o)}}},87:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generator=t.getMouseOrFirstTouchPosition=t.cosineCurvePoints=t.dist=void 0;var n=a(o(359)),r=a(o(126));function a(e){return e&&e.__esModule?e:{default:e}}const i=t.dist=((e,t,o,n)=>Math.sqrt(Math.pow(e-o,2)+Math.pow(t-n,2)));t.cosineCurvePoints=((e,t,o,n,r=10)=>{const a=i(e,t,o,n);if(0===a)return[];const s=(o-e)/a,c=n-t,l=[];for(let u=0;u<=a;u+=1){const d=e+s*u,p=t+c*(1-Math.cos(Math.PI/a*u))/2;r<i(e,t,d,p)&&r<i(o,n,d,p)&&l.push(d,p)}return l}),t.getMouseOrFirstTouchPosition=(e=>{const{type:t,changedTouches:o}=e;if((0,r.default)(["mousedown","mousemove","mouseup"],t))return e;if((0,r.default)(["touchstart","touchmove","touchend"],t))return o.item(0);throw new Error("Unknown event type")}),t.generator=new class e{static get ZEROS_42(){return"000000000000000000000000000000000000000000"}static get ZEROS_12(){return"000000000000"}constructor(){this.sequence=0,this.ptime=0}id(){const t=Date.now();t===this.ptime?this.sequence+=1:this.sequence=0;const o=(e.ZEROS_42+(t-1288834974657).toString(2)).slice(-42),r=(e.ZEROS_12+this.sequence.toString(2)).slice(-12);return(0,n.default)(`${o}${r}`,2)}}}});