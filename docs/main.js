!function(e){function t(t){for(var o,i,s=t[0],c=t[1],l=t[2],d=0,p=[];d<s.length;d++)i=s[d],r[i]&&p.push(r[i][0]),r[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);for(u&&u(t);p.length;)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(o=!1)}o&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={1:0};var a=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="http://localhost:3000/";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;a.push([667,0]),n()}({120:function(e,t,n){var o=n(320);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(23)(o,r);o.locals&&(e.exports=o.locals)},181:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(2)),r=n(88),a=i(n(120));function i(e){return e&&e.__esModule?e:{default:e}}const{white0:s}=a.default;t.default=(e=>{const{points:t,strokeDasharray:n}=e;return o.default.createElement("polyline",{points:(0,r.cosineCurvePoints)(...t),fill:"none",stroke:s,strokeWidth:3,strokeDasharray:n})})},267:function(e,t,n){(e.exports=n(24)(!1)).push([e.i,"html,\nbody,\nmain {\n  width: 100%;\n  height: 100%; }\n\nbody {\n  margin: 0;\n  font-family: sans-serif; }\n\n.ReactCodeMirror {\n  height: 100%; }\n\n.CodeMirror {\n  height: 100%; }\n\n.nwse-resize * {\n  cursor: nwse-resize; }\n\n.user-select-none {\n  cursor: default;\n  -webkit-user-select: none;\n  -webkit-touch-callout: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  -o-user-select: none; }\n\n.move * {\n  cursor: move; }\n",""])},268:function(e,t,n){var o=n(267);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(23)(o,r);o.locals&&(e.exports=o.locals)},269:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,"body {\n  box-sizing: border-box; }\n\n.App__wrap_1SQHV {\n  width: 100%;\n  height: 100%;\n  background-color: #1e1e1e; }\n  .App__wrap_1SQHV footer {\n    position: fixed;\n    left: 0;\n    bottom: 0;\n    width: 100%;\n    border-top: 1px solid #2b2b2b;\n    color: #d4d4d4;\n    background-color: #1e1e1e; }\n\n.App__base_2Rw2G {\n  width: 100%;\n  height: calc(100% - 36px); }\n\n.App__link_36M0v {\n  font-weight: 100;\n  padding: 5px 10px;\n  color: #555555;\n  display: inline-block;\n  text-decoration: none; }\n  .App__link_36M0v > span {\n    padding: 3px 6px;\n    display: inline-block;\n    border-bottom: 1px transparent solid; }\n\n.App__active_3QbdL {\n  color: #d4d4d4; }\n  .App__active_3QbdL > span {\n    border-bottom-color: #007acc; }\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",wrap:"App__wrap_1SQHV",base:"App__base_2Rw2G",link:"App__link_36M0v",active:"App__active_3QbdL"}},270:function(e,t,n){var o=n(269);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(23)(o,r);o.locals&&(e.exports=o.locals)},285:function(e,t,n){"use strict";var o,r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(2),i=d(a),s=n(48),c=d(n(30)),l=d(n(284));n(279),n(277),n(275),n(271);var u=d(n(67));function d(e){return e&&e.__esModule?e:{default:e}}let p=(0,s.connect)(({htmlEditor:e})=>({code:e}))((h=(r=class extends a.Component{onChange(e){const{props:{dispatch:t}}=this;t(c.default.onChangeHtml(e))}render(){const{props:{code:e}}=this;return i.default.createElement(l.default,{value:e,onChange:this.onChange,options:{mode:"htmlmixed",theme:"monokai",styleActiveLine:!0,lineNumbers:!0}})}}).prototype,f="onChange",_=[u.default],b=Object.getOwnPropertyDescriptor(r.prototype,"onChange"),m=r.prototype,g={},Object.keys(b).forEach(function(e){g[e]=b[e]}),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=_.slice().reverse().reduce(function(e,t){return t(h,f,e)||e},g),m&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(m):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(h,f,g),g=null),o=r))||o;var h,f,_,b,m,g;t.default=p},286:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,".HTMLRenderer__base_y4ZXu {\n  display: block;\n  width: 100%;\n  height: 100%;\n  border: none;\n  background-color: white;\n  position: absolute;\n  left: 0;\n  top: 0; }\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",base:"HTMLRenderer__base_y4ZXu"}},287:function(e,t,n){var o=n(286);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(23)(o,r);o.locals&&(e.exports=o.locals)},290:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=h(n(289)),a=h(n(79)),i=h(n(288)),s=h(n(77)),c=n(2),l=h(c),u=n(48),d=n(41),p=h(n(85));function h(e){return e&&e.__esModule?e:{default:e}}n(287);const f=new DOMParser;let _=(0,u.connect)(({blocks:e,pinLinks:t,htmlEditor:n})=>({blocks:e,links:t,html:n}))(o=class extends c.Component{constructor(){super(),this._vars=[]}shouldComponentUpdate(e){const{props:{blocks:t,links:n,html:o}}=this,{blocks:r,links:a,html:i}=e;return!p.default.is(t.slice(1),r.slice(1))||!p.default.is(n,a)||!p.default.is(o,i)}toEvalableString(){const{props:{blocks:e}}=this,t=e.first();return t?this.toEvalableStringSub(t.get("id")):null}toEvalableStringSub(e){if(null===e)return"null";const{props:{blocks:t}}=this,n=t.find(t=>t.get("id")===e),o=n.get("inputPins").map(t=>this.toEvalableStringSub(this.findOutputBlockIdFromLinks({input:{block:e,pin:t.get("index")}}))).toJS();switch(n.get("type")){case d.BLOCK.TYPE_VIEW:return(0,s.default)(o,e=>{const t=e.match(/_timer_variable_\d+_(.*?)_/);return t?`setInterval(() => {\n\t\t\t\t\t\t\t${e}\n\t\t\t\t\t\t\t${t[0]} += 1;\n\t\t\t\t\t\t}, 1000 / ${t[1]})`:e});case d.BLOCK.TYPE_VALUE:return n.get("value");case d.BLOCK.TYPE_FUNCTION:const[e,...t]=o,c=`(${(0,i.default)(t,", ")})`;return e?`${e}[${JSON.stringify(n.get("value"))}]${c}`:`${n.get("value")}${c}`;case d.BLOCK.TYPE_PROPERTY:return`${o[0]}[${JSON.stringify(n.get("value"))}]`;case d.BLOCK.TYPE_OPERATOR:return`(${o[0]}${n.get("value")}${o[1]})`;case d.BLOCK.TYPE_MATH:const{expression:l,args:u,flattenArgs:p}=n.get("handwriting");let h="",f=0;return(0,a.default)(u,({char:e,index:t})=>{h+=l.substring(f,t)+o[(0,r.default)(p,e)],f=t+1}),`(${h+=l.slice(f)})`;case d.BLOCK.TYPE_TIMER:const _=`_timer_variable_${Date.now()}_${n.get("value")}_`;return this._vars.push(_),_;default:return'"UNKNOWN_BLOCK"'}}findOutputBlockIdFromLinks(e){const{props:{links:t}}=this;let n=null;return t.some(t=>!!t.match(e)&&(n=t.getIn(["output","block"]),!0)),n}render(){this._vars=[];const{props:{html:e},_vars:t}=this,n=f.parseFromString(e,"text/html"),o=n.querySelector("body"),r=document.createElement("script"),a=(0,i.default)((0,s.default)(this.toEvalableString(),e=>`parent.postMessage({ type: 'chain-result', value: ${e} }, '*')`),"\n");return r.innerHTML=`\n\t\t\t${(0,i.default)((0,s.default)(t,e=>`let ${e} = 0;`),"\n")}\n\t\t\tparent.postMessage({ type: 'chain-clear' }, '*');\n\t\t\ttry {\n\t\t\t\t(0, eval)(${JSON.stringify(a)});\n\t\t\t} catch (err) {\n\t\t\t\tparent.postMessage({ type: 'chain-error', value: String(err) }, '*');\n\t\t\t}\n\t\t`,o.appendChild(r),l.default.createElement("iframe",{srcDoc:`<!doctype html>${n.documentElement.outerHTML}`,className:"HTMLRenderer__base_y4ZXu"})}})||o;t.default=_},292:function(e,t){e.exports='<!doctype html>\n<html>\n\n<head>\n    <meta charset="utf-8" />\n</head>\n\n<body>\n    <h1>Hello, World!</h1>\n</body>\n\n</html>'},293:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(65),r=i(n(30)),a=i(n(292));function i(e){return e&&e.__esModule?e:{default:e}}t.default=(0,o.handleActions)({[r.default.onChangeHtml]:(e,t)=>{const{payload:n}=t;return n}},a.default)},294:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(85),a=n(84),i=n(65),s=n(30),c=(o=s)&&o.__esModule?o:{default:o};t.default=(0,i.handleActions)({[c.default.addPinLink]:(e,t)=>{const{payload:n}=t,o={input:n.input};return e.filter(e=>!e.match(o)).push(new a.PinLink(n))},[c.default.deleteBlock]:(e,t)=>{const{payload:n}=t;return e.filter(e=>!e.hasBlock(n))},[c.default.removePinLinkByQuery]:(e,t)=>{const{payload:n}=t;return e.filter(e=>!e.match(n))},[c.default.deletePin]:(e,t)=>{const{payload:{id:n,removed:o}}=t;return 0===o?e:e.filter(e=>!e.match({input:{block:n,pin:o}}))}},(0,r.List)())},295:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(84),a=n(65),i=n(30),s=(o=i)&&o.__esModule?o:{default:o};t.default=(0,a.handleActions)({[s.default.startPointLink]:(e,t)=>{const{payload:{x:n,y:o}}=t;return e.start(n,o)},[s.default.endPointLink]:(e,t)=>{const{payload:{x:n,y:o}}=t;return e.end(n,o)}},new r.PointLink)},296:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(84),a=n(65),i=n(30),s=(o=i)&&o.__esModule?o:{default:o};t.default=(0,a.handleActions)({[s.default.updateBlockCreator]:(e,t)=>{const{payload:n}=t;return e.merge(n)},[s.default.showBlockCreator]:(e,t)=>{const{payload:{x:n,y:o}}=t;return e.show(n,o)}},new r.BlockCreator)},30:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(384),a=(o=r)&&o.__esModule?o:{default:o},i=n(65),s=n(88);t.default=(0,i.createActions)({ADD_BLOCK:e=>(0,a.default)({id:s.generator.id()},e),UPDATE_BLOCK:(e,t)=>({id:e,patch:t}),DELTA_MOVE_BLOCK:(e,t,n)=>({id:e,dx:t,dy:n}),TOGGLE_BLOCK_CREATOR:(e,t)=>({x:e,y:t})},"DELETE_BLOCK","UPDATE_BLOCK_CREATOR","ADD_PIN","DELETE_PIN","START_POINT_LINK","END_POINT_LINK","ADD_PIN_LINK","REMOVE_PIN_LINK_BY_QUERY","ON_CHANGE_HTML","CLEAR_VIEW_BLOCK","PUSH_VIEW_BLOCK","SHOW_BLOCK_CREATOR","UPDATE_HANDWRITING","DELTA_RESIZE_BLOCK")},302:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(85),r=n(84),a=n(65),i=l(n(30)),s=n(41),c=l(n(120));function l(e){return e&&e.__esModule?e:{default:e}}const{blue2:u,white0:d}=c.default;t.default=(0,a.handleActions)({[i.default.addBlock]:(e,t)=>{const{payload:n}=t;return e.push(new r.Block(n))},[i.default.updateBlock]:(e,t)=>{const{payload:{id:n,patch:o}}=t,r=e.findIndex(e=>e.get("id")===n);return e.update(r,e=>e.merge(o).set("handwriting",s.EMPTY_HANDWRITING))},[i.default.deleteBlock]:(e,t)=>{const{payload:n}=t,o=e.findIndex(e=>e.get("id")===n);return e.filter((e,t)=>t!==o)},[i.default.deltaMoveBlock]:(e,t)=>{const{payload:{id:n,dx:o,dy:r}}=t,a=e.findIndex(e=>e.get("id")===n);return e.update(a,e=>e.dmove(o,r))},[i.default.addPin]:(e,t)=>{const{payload:n}=t,o=e.findIndex(e=>e.get("id")===n);return e.update(o,e=>e.updateIn(["inputPins"],t=>t.push(e.createPin(e.type===s.BLOCK.TYPE_FUNCTION?u:d,s.PIN.TYPE_INPUT))).recalculateHeight())},[i.default.deletePin]:(e,t)=>{const{payload:{id:n}}=t,o=e.findIndex(e=>e.get("id")===n);return e.update(o,e=>e.updateIn(["inputPins"],e=>e.slice(0,Math.max(1,e.size-1))).recalculateHeight())},[i.default.clearViewBlock]:e=>e.update(0,e=>e.set("value","")),[i.default.pushViewBlock]:(e,t)=>{const{payload:n}=t;return e.update(0,e=>{const t=e.get("value");return e.set("value",t?`${t}\n${n}`:n)})},[i.default.updateHandwriting]:(e,t)=>{const{payload:{id:n,handwriting:o}}=t,r=e.findIndex(e=>e.get("id")===n),{flattenArgs:{length:a},expression:i}=o;return e.update(r,e=>{if(e.get("type")===s.BLOCK.TYPE_MATH){e=e.updateIn(["inputPins"],e=>e.clear());for(let t=0;t<a;t+=1)e=e.updateIn(["inputPins"],t=>t.push(e.createPin(d,s.PIN.TYPE_INPUT)))}return e.set("handwriting",o).set("value",i)})},[i.default.deltaResizeBlock]:(e,t)=>{const{payload:{id:n,dw:o,dh:r}}=t,a=e.findIndex(e=>e.get("id")===n);return e.update(a,e=>e.dresize(o,r))}},(0,o.List)())},303:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(172),r=l(n(302)),a=l(n(296)),i=l(n(295)),s=l(n(294)),c=l(n(293));function l(e){return e&&e.__esModule?e:{default:e}}t.default=(0,o.combineReducers)({blocks:r.default,blockCreator:a.default,pointLink:i.default,pinLinks:s.default,htmlEditor:c.default})},304:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,".Chain__base_L0Lag {\n  background-color: #1e1e1e;\n  position: relative;\n  width: 100%;\n  height: 100%; }\n  .Chain__base_L0Lag > svg {\n    display: block;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    left: 0;\n    top: 0; }\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",base:"Chain__base_L0Lag"}},305:function(e,t,n){var o=n(304);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(23)(o,r);o.locals&&(e.exports=o.locals)},318:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=d(n(317)),a=d(n(42)),i=d(n(180)),s=n(2),c=d(s),l=n(41),u=d(n(67));function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t,n,o,r){var a={};return Object.keys(o).forEach(function(e){a[e]=o[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}const h=l.PIN.RADIUS+1;let f=(p((o=class extends s.Component{constructor(){super(),this.state={enter:!1,connecting:!1}}onMouseDownOrTouchStart(e){const{props:{model:t,parent:n,onMouseDownOrTouchStart:o}}=this;o(e,t,n),document.addEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.addEventListener("touchend",this.onMouseUpOrTouchEndDocument),this.setState({connecting:!0})}onMouseup(e){const{props:{model:t,onMouseUpOrTouchEnd:n,parent:o}}=this;n(e,t,o)}onMouseEnter(){this.setState({enter:!0})}onMouseLeave(){this.setState({enter:!1})}onTouchEnd(e){const{pageX:t,pageY:n}=e.changedTouches.item(0);(0,i.default)(document.querySelectorAll("[data-pin]"),o=>{const{left:s,top:c,width:l,height:u}=o.getBoundingClientRect();return s<=t&&t<=s+l&&c<=n&&n<=c+u&&((0,i.default)((0,a.default)(o),t=>{if((0,r.default)(t,"__reactInternalInstance$")){const{_currentElement:{_owner:{_currentElement:{props:{model:n,onMouseUpOrTouchEnd:r,parent:a}}}}}=o[t];return r(e,n,a),!0}return!1}),!0)})}onMouseUpOrTouchEndDocument(){document.removeEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.removeEventListener("touchend",this.onMouseUpOrTouchEndDocument),this.setState({connecting:!1})}render(){const{props:{model:e},state:{enter:t,connecting:n}}=this,o=e.get("color"),r=e.get("type");return c.default.createElement("svg",{"data-pin":!0,onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart,onMouseUp:this.onMouseup,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onTouchEnd:this.onTouchEnd,style:{position:"absolute",left:e.get("cx")-h,top:e.get("cy")-h,width:2*l.PIN.WIDTH,height:2*l.PIN.WIDTH,cursor:"pointer"}},c.default.createElement("circle",{cx:h,cy:h,r:l.PIN.S_RADIUS,fill:r===l.PIN.TYPE_INPUT?"none":r===l.PIN.TYPE_OUTPUT?o:"red",stroke:o}),t||n||e.get("linked")?c.default.createElement("circle",{cx:h,cy:h,r:l.PIN.RADIUS,fill:"none",stroke:o}):null)}}).prototype,"onMouseDownOrTouchStart",[u.default],Object.getOwnPropertyDescriptor(o.prototype,"onMouseDownOrTouchStart"),o.prototype),p(o.prototype,"onMouseup",[u.default],Object.getOwnPropertyDescriptor(o.prototype,"onMouseup"),o.prototype),p(o.prototype,"onMouseEnter",[u.default],Object.getOwnPropertyDescriptor(o.prototype,"onMouseEnter"),o.prototype),p(o.prototype,"onMouseLeave",[u.default],Object.getOwnPropertyDescriptor(o.prototype,"onMouseLeave"),o.prototype),p(o.prototype,"onTouchEnd",[u.default],Object.getOwnPropertyDescriptor(o.prototype,"onTouchEnd"),o.prototype),p(o.prototype,"onMouseUpOrTouchEndDocument",[u.default],Object.getOwnPropertyDescriptor(o.prototype,"onMouseUpOrTouchEndDocument"),o.prototype),o);t.default=f},319:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=l(n(79)),a=n(2),i=l(a),s=n(48),c=l(n(181));function l(e){return e&&e.__esModule?e:{default:e}}let u=(0,s.connect)(({blocks:e})=>({blocks:e}))(o=class extends a.Component{render(){const{props:{blocks:e,model:t}}=this,n=[];return(0,r.default)(["output","input"],o=>{const r=e.find(e=>e.get("id")===t.getIn([o,"block"])).getIn([`${o}Pins`,t.getIn([o,"pin"])]);n.push(r.get("cx"),r.get("cy"))}),i.default.createElement(c.default,{points:n})}})||o;t.default=u},320:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,"\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa"}},321:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(2)),r=a(n(181));function a(e){return e&&e.__esModule?e:{default:e}}t.default=(e=>{const{model:t}=e;return o.default.createElement(r.default,{points:t.points(),strokeDasharray:[5,5]})})},322:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,'.BlockCreator__shadow_Y8igC, .BlockCreator__base_1ZSFp {\n  box-shadow: 0 3px 3px 0 rgba(0, 0, 0, 0.14), 0 1px 7px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -1px rgba(0, 0, 0, 0.2); }\n\n.BlockCreator__base_1ZSFp {\n  background-color: #1e1e1e;\n  border: 1px solid #2b2b2b;\n  color: #d4d4d4;\n  width: 200px;\n  padding: 10px;\n  box-sizing: border-box;\n  font-family: Menlo, Monaco, "Courier New", monospace;\n  font-size: 12px; }\n  .BlockCreator__base_1ZSFp select {\n    display: block;\n    background-color: #2b2b2b;\n    color: inherit;\n    width: 100%;\n    border: 1px solid transparent;\n    margin-bottom: 5px;\n    font: inherit;\n    outline: none;\n    -webkit-appearance: none;\n    padding: 2px 4px; }\n    .BlockCreator__base_1ZSFp select:focus {\n      border-color: #007acc; }\n  .BlockCreator__base_1ZSFp textarea {\n    width: 100%;\n    background-color: #2b2b2b;\n    font: inherit;\n    color: inherit;\n    height: 100%;\n    box-sizing: border-box;\n    resize: vertical;\n    outline: none;\n    display: block;\n    margin-bottom: 5px;\n    border: 1px solid transparent;\n    border-radius: 0; }\n    .BlockCreator__base_1ZSFp textarea:focus {\n      border-color: #007acc; }\n  .BlockCreator__base_1ZSFp button {\n    display: inline-block;\n    background-color: #2b2b2b;\n    color: inherit;\n    border-radius: 4px;\n    font: inherit;\n    border: none;\n    outline: none;\n    cursor: pointer; }\n',""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",shadow:"BlockCreator__shadow_Y8igC",base:"BlockCreator__base_1ZSFp"}},323:function(e,t,n){var o=n(322);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(23)(o,r);o.locals&&(e.exports=o.locals)},332:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r,a=_(n(331)),i=_(n(77)),s=n(2),c=_(s),l=n(80),u=n(48),d=_(n(30)),p=n(41),h=n(121),f=_(n(67));function _(e){return e&&e.__esModule?e:{default:e}}function b(e,t,n,o,r){var a={};return Object.keys(o).forEach(function(e){a[e]=o[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}n(323);const m=(0,i.default)(p.BLOCK.CREATABLE_BLOCK_LIST,e=>`${(0,a.default)(e)} Block`);let g=(0,u.connect)()((b((r=class extends s.Component{componentWillUpdate(e){const{model:t}=e,{props:{model:n}}=this;!n.get("visible")&&t.get("visible")&&(document.addEventListener("mousedown",this.onMouseDownOrTouchStartDocument),document.addEventListener("touchstart",this.onMouseDownOrTouchStartDocument))}onClick(){const{props:{model:e,dispatch:t}}=this;document.removeEventListener("mousedown",this.onMouseDownOrTouchStartDocument),document.removeEventListener("touchstart",this.onMouseDownOrTouchStartDocument),t((0,h.batchActions)([d.default.addBlock({x:e.get("x"),y:e.get("y"),type:e.get("selected")}),d.default.updateBlockCreator({visible:!1})]))}onChangeSelect(e){const{currentTarget:{value:t}}=e,{props:{dispatch:n}}=this;n(d.default.updateBlockCreator({selected:t}))}onMouseDownOrTouchStartDocument(e){const{target:t}=e,{props:{dispatch:n}}=this,o=(0,l.findDOMNode)(this);o&&!o.contains(t)&&(n(d.default.updateBlockCreator({visible:!1})),document.removeEventListener("mousedown",this.onMouseDownOrTouchStartDocument),document.removeEventListener("touchstart",this.onMouseDownOrTouchStartDocument))}render(){const{props:{model:e}}=this;return e.get("visible")?c.default.createElement("div",{className:"BlockCreator__base_1ZSFp",style:{position:"absolute",left:e.get("x"),top:e.get("y")}},c.default.createElement("select",{value:e.get("selected"),onChange:this.onChangeSelect},(0,i.default)(p.BLOCK.CREATABLE_BLOCK_LIST,(e,t)=>c.default.createElement("option",{value:e,key:t},m[t]))),c.default.createElement("button",{onClick:this.onClick},"ADD")):null}}).prototype,"onClick",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onClick"),r.prototype),b(r.prototype,"onChangeSelect",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onChangeSelect"),r.prototype),b(r.prototype,"onMouseDownOrTouchStartDocument",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseDownOrTouchStartDocument"),r.prototype),o=r))||o;t.default=g},334:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,'.Block__shadow_2-4hx, .Block__base_3ulp8 {\n  box-shadow: 0 3px 3px 0 rgba(0, 0, 0, 0.14), 0 1px 7px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -1px rgba(0, 0, 0, 0.2); }\n\n.Block__base_3ulp8 {\n  font-size: 12px;\n  color: #d4d4d4;\n  border: 1px solid #2b2b2b;\n  background-color: #1e1e1e;\n  box-sizing: border-box;\n  font-family: Menlo, Monaco, "Courier New", monospace;\n  display: flex;\n  flex-direction: column;\n  position: relative; }\n  .Block__base_3ulp8 button {\n    display: inline-block;\n    text-decoration: none;\n    color: inherit;\n    border: none;\n    font: inherit;\n    padding: 1px 8px;\n    outline: none;\n    cursor: pointer;\n    background-color: #2b2b2b;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    margin: 0; }\n    .Block__base_3ulp8 button:not(:first-of-type) {\n      margin-left: 1px; }\n  .Block__base_3ulp8 textarea {\n    width: 100%;\n    border: none;\n    background-color: #2b2b2b;\n    font: inherit;\n    color: inherit;\n    height: 100%;\n    box-sizing: border-box;\n    resize: none;\n    outline: none;\n    display: block;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    border-radius: 0; }\n\n.Block__math_2WDqM {\n  background-color: #2b2b2b;\n  height: calc(100% - 23px);\n  width: 100%; }\n\n.Block__math-arg_3aTuw {\n  position: absolute;\n  background-color: #2b2b2b;\n  width: 20px;\n  left: 2px;\n  text-align: center; }\n\n.Block__textarea-div_19vCU, .Block__math-div_2fcEH {\n  height: calc(100% - 16px);\n  padding: 5px;\n  box-sizing: border-box;\n  position: relative; }\n  .Block__textarea-div_19vCU input, .Block__math-div_2fcEH input {\n    border: none;\n    background-color: #2b2b2b;\n    font-size: inherit;\n    color: #d4d4d4;\n    width: 100%;\n    outline: none;\n    box-sizing: border-box;\n    margin-bottom: 5px;\n    font-family: Menlo, Monaco, "Courier New", monospace;\n    padding: 2px; }\n\n.Block__math-div_2fcEH {\n  padding-left: 24px; }\n\n.Block__red_1kUYK {\n  background-color: #f44336 !important; }\n\n.Block__resizer_2BB8h {\n  background-color: transparent;\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  width: 5px;\n  height: 5px;\n  cursor: nwse-resize; }\n\n.ms-editor .loader {\n  width: 100px !important;\n  height: 100px !important;\n  top: calc(50% - 65px) !important;\n  left: calc(50% - 65px) !important; }\n\n#pendingStrokes * {\n  color: red !important; }\n\n#MODEL-viewTransform {\n  stroke: #d4d4d4; }\n',""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",shadow:"Block__shadow_2-4hx",base:"Block__base_3ulp8",math:"Block__math_2WDqM","math-arg":"Block__math-arg_3aTuw","textarea-div":"Block__textarea-div_19vCU","math-div":"Block__math-div_2fcEH",red:"Block__red_1kUYK",resizer:"Block__resizer_2BB8h"}},335:function(e,t,n){var o=n(334);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(23)(o,r);o.locals&&(e.exports=o.locals)},338:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(186)),r=a(n(79));function a(e){return e&&e.__esModule?e:{default:e}}var i,s,c,l,u,d,p,h,f,_,b;t.default=(e=>{const t=(e=e,s=function(){var t=e;return t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\s/g,"")).replace(/\\times/g,"*")).replace(/\\cdot/g,"*")).replace(/\\div/g,"/")).replace(/([0-9]+)([a-zA-Z]+)/g,"$1*$2")).replace(/([0-9a-zA-Z\.]+)\\pi/g,"$1*Math.PI")).replace(/\\pi([0-9a-zA-Z\.]+)/g,"Math.PI*$1")).replace(/([0-9a-zA-Z\.]+)\\pi([0-9a-zA-Z\.]+)/g,"$1*Math.PI*$2")).replace(/\\pi/g,"Math.PI"),t=c(t),t=l(t),t=u(t),t=d(t),t=p(t),t=f(t),t=(t=(t=(t=(t=(t=h(t)).replace(/\\left\(/g,"(")).replace(/\\right\)/g,")")).replace(/([0-9a-zA-Z\.]+)\Math/g,"$1*Math")).replace(/\)Math/g,")*Math")).replace(/\)([0-9a-zA-Z\.]+)/g,")*$1")},c=function(e){for(;e.search(/\\frac\{(((?![\{\}]).)*)\}\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\frac\{(((?![\{\}]).)*)\}\{(((?![\{\}]).)*)\}/g,"($1)/($3)");for(;e.search(/\\dfrac\{(((?![\{\}]).)*)\}\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\dfrac\{(((?![\{\}]).)*)\}\{(((?![\{\}]).)*)\}/g,"($1)/($3)");return e.search(/\\frac/)>=0&&(e=b("fraction",e)),e.search(/\\dfrac/)>=0&&(e=b("fraction",e)),e},l=function(e){for(;e.search(/\\sqrt\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\sqrt\{(((?![\{\}]).)*)\}/g,"Math.sqrt($1)");return e.search(/\\sqrt\{/)>=0&&(e=b("square root",e)),e},u=function(e){for(;e.search(/\\sqrt\[(((?![\{\}]).)*)\]\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\sqrt\[(((?![\{\}]).)*)\]\{(((?![\{\}]).)*)\}/g,"Math.pow($3,1/$1)");return e.search(/\\sqrt\[/)>=0&&(e=b("nth root",e)),e},d=function(e){for(;e.search(/([0-9a-zA-Z\.]+)\^\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/([0-9a-zA-Z\.]+)\^\{(((?![\{\}]).)*)\}/g,"Math.pow($1,$2)");for(;e.search(/([0-9a-zA-Z\.]+)\^([0-9a-zA-Z\.]+)/)>=0;)e=e.replace(/([0-9a-zA-Z\.]+)\^([0-9a-zA-Z\.]+)/g,"Math.pow($1,$2)");for(;e.search(/\\left\(([0-9a-zA-Z\.\+\*\-\\]+)\\right\)\^([0-9a-zA-Z\.]+)/)>=0;)e=e.replace(/\\left\(([0-9a-zA-Z\.\+\*\-\\]+)\\right\)\^([0-9a-zA-Z\.]+)/g,"Math.pow($1,$2)");for(;e.search(/\\left\(([0-9a-zA-Z\.\+\*\-\\]+)\\right\)\^\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\left\(([0-9a-zA-Z\.\+\*\-\\]+)\\right\)\^\{(((?![\{\}]).)*)\}/g,"Math.pow($1,$2)");for(;e.search(/\\left\(([0-9a-zA-Z\.\+\*\-\\\(\)\/]+)\\right\)\^\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\left\(([0-9a-zA-Z\.\+\*\-\\\(\)\/]+)\\right\)\^\{(((?![\{\}]).)*)\}/g,"Math.pow($1,$2)");return e.search(/\^/)>=0&&(e=b("nth power",e)),e},p=function(e){return _("sin",e)},f=function(e){return _("tan",e)},h=function(e){return _("cos",e)},_=function(e,t){for(var n=/\\sin\\left\(([0-9a-zA-Z\.\+\*\-\\\(\)\/]+)\\right\)/;t.search(n)>=0;)t=t.replace(n,"Math."+e+"($1)");for(var o=new RegExp("\\\\"+e+"([0-9a-zA-Z]+)");t.search(o)>=0;)t=t.replace(o,"Math."+e+"($1)");var r=new RegExp("\\\\"+e);return t.search(r)>=0&&(t=b(e,t)),t},b=function(e,t){var n,o,r,a,i,s,_,b,m,g;switch(e){case"fraction":(n=t.match(/\\frac.*/)[0]).search(/\\frac/);break;case"square root":(n=t.match(/\\sqrt\{.*/)[0]).search(/\\sqrt\{/);break;case"nth root":(n=t.match(/\\sqrt\[.*/)[0]).search(/\\sqrt\[/);break;case"nth power":(n=t.match(/\^.*/)[0]).search(/\^/);break;case"sin":console.log(t),console.log(t.match(/\\sin\{.*/)),(n=t.match(/\\sin\{.*/)[0]).search(/\\sin\{/);break;case"tan":(n=t.match(/\\tan\{.*/)[0]).search(/\\tan\{/);break;case"cos":(n=t.match(/\\cos\{.*/)[0]).search(/\\cos\{/);break;default:return}if(a=n.search(/\\frac/),i=n.search(/\\sqrt\{/),(o=[a,s=n.search(/\\sqrt\[/),i,_=n.search(/\^/),b=n.search(/\\sin\{/),g=n.search(/\\tan\{/),m=n.search(/\\cos\{/)]).sort(function(e,t){return t-e}),(r=o[o.indexOf(0)-1])<=0||void 0===r)throw"syntax error";switch(r){case a:t=c(t);break;case i:t=l(t);break;case s:t=u(t);break;case _:t=d(t);break;case b:t=p(t);break;case g:t=f(t);break;case m:t=h(t)}switch(e){case"fraction":t=c(t);break;case"square root":t=l(t);break;case"nth root":t=u(t);break;case"nth power":t=d(t);break;case"sin":t=p(t);break;case"tan":t=f(t);break;case"cos":t=h(t)}return t},s()),n=(e=>{const{length:t}=e,n=[];for(let o=0;o<t;o+=1){const t=e[o-1]||"",r=e[o]||"",a=e[o+1]||"";/\.|[A-Za-z]/.test(t)||!/[A-Za-z]/.test(r)||/\.|[A-Za-z]/.test(a)||n.push({index:o,char:r})}return n})(t),a=[];return(0,r.default)(n,({char:e})=>{(0,o.default)(a,e)||a.push(e)}),{expression:t,args:n,flattenArgs:a}})},340:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TYPE_OUTPUT="OUTPUT_PIN",t.TYPE_INPUT="INPUT_PIN",t.RADIUS=7,t.S_RADIUS=4,t.WIDTH=8},341:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WIDTH=200,t.HEIGHT=70;const o=t.TYPE_VALUE="VALUE",r=t.TYPE_FUNCTION="FUNCTION",a=t.TYPE_PROPERTY="PROPERTY",i=t.TYPE_OPERATOR="OPERATOR",s=t.TYPE_VIEW="VIEW",c=t.TYPE_MATH="MATH";t.TYPE_TIMER="TIMER",t.CREATABLE_BLOCK_LIST=[o,r,a,i,s,c]},358:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=u(n(357)),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i=n(2),s=u(i),c=u(n(80)),l=u(n(67));function u(e){return e&&e.__esModule?e:{default:e}}let d=(p=(o=class extends i.Component{constructor(){super(),this.tab=!1,this.selectionStart=-1}componentDidUpdate(){const{selectionStart:e}=this;if(-1<e){const t=e+1;c.default.findDOMNode(this).setSelectionRange(t,t)}this.selectionStart=-1}onKeyDown(...e){const{props:{onKeyDown:t}}=this,{keyCode:n,currentTarget:{selectionStart:o}}=e[0];9===n&&(this.selectionStart=o),"function"==typeof t&&t(...e)}render(){const{props:e}=this,t=(0,r.default)(e);return delete t.onKeyDown,s.default.createElement("textarea",a({},t,{onKeyDown:this.onKeyDown}))}}).prototype,h="onKeyDown",f=[l.default],_=Object.getOwnPropertyDescriptor(o.prototype,"onKeyDown"),b=o.prototype,m={},Object.keys(_).forEach(function(e){m[e]=_[e]}),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=f.slice().reverse().reduce(function(e,t){return t(p,h,e)||e},m),b&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(b):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(p,h,m),m=null),o);var p,h,f,_,b,m;t.default=d},41:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_HANDWRITING=t.PIN=t.BLOCK=void 0;var o=a(n(341)),r=a(n(340));function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.BLOCK=o,t.PIN=r,t.EMPTY_HANDWRITING={expression:"",args:[],flattenArgs:[]}},439:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r,a=v(n(77)),i=v(n(196)),s=n(2),c=v(s),l=n(48),u=v(n(30)),d=v(n(67)),p=v(n(358)),h=n(88),f=n(41),_=v(n(339)),b=v(n(338)),m=v(n(337)),g=v(n(336));function v(e){return e&&e.__esModule?e:{default:e}}function y(e,t,n,o,r){var a={};return Object.keys(o).forEach(function(e){a[e]=o[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}n(335),window.ontouchmove=(()=>{});const P=new h.TemporaryUserSelectNone;let E=(0,l.connect)()((y((r=class extends s.Component{constructor(){super(),this._prevX=0,this._prevY=0,this._editor=c.default.createRef(),this._canClearMathEditor=!0}componentDidMount(){const{props:{model:e},_editor:{current:t}}=this,n=e.get("type");t&&(t.addEventListener("exported",this.onExported),_.default.register(t,{recognitionParams:{type:n===f.BLOCK.TYPE_MATH||n===f.BLOCK.TYPE_VALUE||n===f.BLOCK.TYPE_OPERATOR?"MATH":"TEXT",apiVersion:"V4",server:{applicationKey:"331b4bdf-7ace-4265-94f1-b01504c78743",hmacKey:"44f4f4ce-fd0f-48a1-b517-65d2b9465413"},v4:{math:{mimeTypes:["application/x-latex"]}}}}))}onExported(e){const{props:{model:t,dispatch:n},_canClearMathEditor:o}=this,{detail:{exports:r}}=e;o&&n(u.default.updateHandwriting({id:t.get("id"),handwriting:(0,b.default)(void 0===r?"":r["application/x-latex"]||r["text/plain"]||"")})),this._canClearMathEditor=!0}clearMathEditor(){const{_editor:{current:{editor:e}}}=this;e.clear()}undoMathEditor(){const{_editor:{current:{editor:e}}}=this;e.undo()}redoMathEditor(){const{_editor:{current:{editor:e}}}=this;e.redo()}onChange(e){const{props:{model:t,dispatch:n},_editor:{current:{editor:o}}}=this,{currentTarget:{value:r}}=e;this._canClearMathEditor=!1,n(u.default.updateBlock(t.get("id"),{value:r})),o.clear()}onClickDeleteButton(){const{props:{model:e,dispatch:t}}=this,n=e.get("id");t(u.default.deleteBlock(n))}onMouseDownOrTouchStart(e){const{target:{dataset:t}}=e;if((0,i.default)(t,"draggable")){const{pageX:t,pageY:n}=(0,h.getMouseOrFirstTouchPosition)(e);this._prevX=t,this._prevY=n,document.body.classList.add("move"),P.search(),document.addEventListener("mousemove",this.onMouseMoveOrTouchMoveDocument),document.addEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.addEventListener("touchmove",this.onMouseMoveOrTouchMoveDocument),document.addEventListener("touchend",this.onMouseUpOrTouchEndDocument)}}onMouseMoveOrTouchMoveDocument(e){const{pageX:t,pageY:n}=(0,h.getMouseOrFirstTouchPosition)(e),{props:{model:o,dispatch:r},_prevX:a,_prevY:i}=this;e.preventDefault(),r(u.default.deltaMoveBlock(o.get("id"),t-a,n-i)),this._prevX=t,this._prevY=n}onMouseUpOrTouchEndDocument(){document.body.classList.remove("move"),P.remove(),document.removeEventListener("mousemove",this.onMouseMoveOrTouchMoveDocument),document.removeEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.removeEventListener("touchmove",this.onMouseMoveOrTouchMoveDocument),document.removeEventListener("touchend",this.onMouseUpOrTouchEndDocument)}addPin(){const{props:{model:e,dispatch:t}}=this;t(u.default.addPin(e.get("id")))}deletePin(){const{props:{model:e,dispatch:t}}=this;t(u.default.deletePin({id:e.get("id"),removed:e.get("inputPins").size-1}))}onKeyDown(e){const{keyCode:t,currentTarget:{selectionStart:n,selectionEnd:o}}=e,{props:{dispatch:r,model:a}}=this;if(9===t){e.preventDefault();const t=a.get("value");r(u.default.updateBlock(a.get("id"),{value:`${t.substring(0,n)}\t${t.substring(o)}`}))}}onResizeMouseDown(e){const{pageX:t,pageY:n}=e;this._prevX=t,this._prevY=n,document.body.classList.add("nwse-resize"),P.search(),document.body.addEventListener("mousemove",this.onResizeMouseMoveDoc),document.body.addEventListener("mouseup",this.onResizeMouseUpDoc)}onResizeMouseMoveDoc(e){const{_prevX:t,_prevY:n,props:{dispatch:o,model:r}}=this,{pageX:a,pageY:i}=e;o(u.default.deltaResizeBlock({dw:a-t,dh:i-n,id:r.get("id")})),this._prevX=a,this._prevY=i}onResizeMouseUpDoc(){document.body.classList.remove("nwse-resize"),P.remove(),document.body.removeEventListener("mousemove",this.onResizeMouseMoveDoc),document.body.removeEventListener("mouseup",this.onResizeMouseUpDoc)}render(){const{props:{model:e}}=this,t=e.get("color"),n=e.get("type");if(n===f.BLOCK.TYPE_TIMER)return c.default.createElement("div",{"data-draggable":!0,className:"Block__base_3ulp8",onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart,style:{position:"absolute",left:e.get("x"),top:e.get("y"),width:e.get("width"),height:e.get("height")}},c.default.createElement("div",{"data-draggable":!0},e.get("deletable")?c.default.createElement("button",{className:"Block__red_1kUYK",onClick:this.onClickDeleteButton},"x"):null,c.default.createElement("span",null,"FPS")),c.default.createElement("div",{"data-draggable":!0,className:"Block__textarea-div_19vCU"},c.default.createElement(p.default,{readOnly:!e.get("editable"),onChange:this.onChange,value:e.get("value"),spellCheck:!1,style:{borderLeft:`5px solid ${t}`},onKeyDown:this.onKeyDown})));if(n!==f.BLOCK.TYPE_VIEW){const{flattenArgs:n}=e.get("handwriting");return c.default.createElement("div",{"data-draggable":!0,className:"Block__base_3ulp8",onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart,style:{position:"absolute",left:e.get("x"),top:e.get("y"),width:e.get("width"),height:e.get("height")}},c.default.createElement("div",{"data-draggable":!0},e.get("deletable")?c.default.createElement("button",{className:"Block__red_1kUYK",onClick:this.onClickDeleteButton},"x"):null,e.get("changeable")?c.default.createElement("button",{onClick:this.addPin},"+"):null,e.get("changeable")?c.default.createElement("button",{onClick:this.deletePin},"-"):null,c.default.createElement("button",{onClick:this.clearMathEditor},"Clear"),c.default.createElement("button",{onClick:this.undoMathEditor},c.default.createElement(m.default,null)),c.default.createElement("button",{onClick:this.redoMathEditor},c.default.createElement(g.default,null))),c.default.createElement("div",{"data-draggable":!0,className:"Block__math-div_2fcEH"},c.default.createElement("input",{type:"text",readOnly:!e.get("editable"),value:e.get("value"),onChange:this.onChange,style:{borderLeft:`5px solid ${t}`}}),(0,a.default)(n,(e,t)=>c.default.createElement("div",{className:"Block__math-arg_3aTuw",key:t,style:{top:2*f.PIN.WIDTH*t+6}},e)),c.default.createElement("div",{className:"Block__math_2WDqM",ref:this._editor})),c.default.createElement("div",{className:"Block__resizer_2BB8h",onMouseDown:this.onResizeMouseDown}))}return c.default.createElement("div",{"data-draggable":!0,className:"Block__base_3ulp8",onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart,style:{position:"absolute",left:e.get("x"),top:e.get("y"),width:e.get("width"),height:e.get("height")}},c.default.createElement("div",{"data-draggable":!0},e.get("deletable")?c.default.createElement("button",{className:"Block__red_1kUYK",onClick:this.onClickDeleteButton},"x"):null,e.get("changeable")?c.default.createElement("button",{onClick:this.addPin},"+"):null,e.get("changeable")?c.default.createElement("button",{onClick:this.deletePin},"-"):null),c.default.createElement("div",{"data-draggable":!0,className:"Block__textarea-div_19vCU"},c.default.createElement(p.default,{readOnly:!e.get("editable"),onChange:this.onChange,value:e.get("value"),spellCheck:!1,style:{borderLeft:`5px solid ${t}`},onKeyDown:this.onKeyDown})),c.default.createElement("div",{className:"Block__resizer_2BB8h",onMouseDown:this.onResizeMouseDown}))}}).prototype,"onExported",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"onExported"),r.prototype),y(r.prototype,"clearMathEditor",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"clearMathEditor"),r.prototype),y(r.prototype,"undoMathEditor",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"undoMathEditor"),r.prototype),y(r.prototype,"redoMathEditor",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"redoMathEditor"),r.prototype),y(r.prototype,"onChange",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"onChange"),r.prototype),y(r.prototype,"onClickDeleteButton",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"onClickDeleteButton"),r.prototype),y(r.prototype,"onMouseDownOrTouchStart",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseDownOrTouchStart"),r.prototype),y(r.prototype,"onMouseMoveOrTouchMoveDocument",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseMoveOrTouchMoveDocument"),r.prototype),y(r.prototype,"onMouseUpOrTouchEndDocument",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseUpOrTouchEndDocument"),r.prototype),y(r.prototype,"addPin",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"addPin"),r.prototype),y(r.prototype,"deletePin",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"deletePin"),r.prototype),y(r.prototype,"onKeyDown",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyDown"),r.prototype),y(r.prototype,"onResizeMouseDown",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"onResizeMouseDown"),r.prototype),y(r.prototype,"onResizeMouseMoveDoc",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"onResizeMouseMoveDoc"),r.prototype),y(r.prototype,"onResizeMouseUpDoc",[d.default],Object.getOwnPropertyDescriptor(r.prototype,"onResizeMouseUpDoc"),r.prototype),o=r))||o;t.default=E},452:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r,a=y(n(79)),i=n(2),s=y(i),c=n(48),l=y(n(439)),u=y(n(332)),d=y(n(30)),p=y(n(321)),h=y(n(319)),f=y(n(67)),_=y(n(318)),b=n(41),m=n(121),g=n(88),v=n(179);function y(e){return e&&e.__esModule?e:{default:e}}function P(e,t,n,o,r){var a={};return Object.keys(o).forEach(function(e){a[e]=o[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}n(305),window.ontouchmove=(()=>{});let E=(0,c.connect)(({blocks:e,pointLink:t,pinLinks:n,blockCreator:o})=>({blocks:e,link:t,links:n,blockCreator:o}))((P((r=class e extends i.Component{static convertPinTypeToPinLinkKey(e){switch(e){case b.PIN.TYPE_OUTPUT:return"output";case b.PIN.TYPE_INPUT:return"input";default:throw new Error("Unknown pin type")}}componentDidMount(){window.addEventListener("message",this.onMessage)}componentWillUnmount(){window.removeEventListener("message",this.onMessage)}onConnectStart(e,t,n){const{props:{dispatch:o}}=this,r=t.get("type"),a=t.get("index"),i=[d.default.startPointLink({x:t.get("cx"),y:t.get("cy")})];document.addEventListener("mousemove",this.onConnecting),document.addEventListener("mouseup",this.onConnectEnd),document.addEventListener("touchmove",this.onConnecting),document.addEventListener("touchend",this.onConnectEnd),window.__connection__={block:n,pin:a,pinType:r},r===b.PIN.TYPE_INPUT&&i.push(d.default.removePinLinkByQuery({input:{block:n,pin:a}})),o((0,m.batchActions)(i))}onConnecting(e){const{props:{dispatch:t}}=this,{clientX:n,clientY:o}=(0,g.getMouseOrFirstTouchPosition)(e);e.preventDefault(),t(d.default.endPointLink({x:n,y:o}))}onConnectEnd(){const{props:{dispatch:e}}=this;e(d.default.startPointLink({x:0,y:0})),document.removeEventListener("mousemove",this.onConnecting),document.removeEventListener("mouseup",this.onConnectEnd),document.removeEventListener("touchmove",this.onConnecting),document.removeEventListener("touchend",this.onConnectEnd)}onConnectPin(t,n,o){const{__connection__:{block:r,pin:a,pinType:i}}=window,{props:{dispatch:s}}=this,c=n.get("index"),l=n.get("type");r!==o&&i!==l&&s(d.default.addPinLink({[e.convertPinTypeToPinLinkKey(i)]:{block:r,pin:a},[e.convertPinTypeToPinLinkKey(l)]:{block:o,pin:c}}))}onMessage(e){const{props:{dispatch:t}}=this,{data:{type:n,value:o}}=e;"chain-result"===n?t(d.default.pushViewBlock(JSON.stringify(o))):"chain-error"===n?v.toast.error(o,{position:v.toast.POSITION.BOTTOM_RIGHT}):"chain-clear"===n&&t(d.default.clearViewBlock())}onMouseDownOrTouchStart(e){const{target:t,currentTarget:n}=e,{clientX:o,clientY:r}=(0,g.getMouseOrFirstTouchPosition)(e),{props:{dispatch:a}}=this;t===n&&a(d.default.showBlockCreator({x:o,y:r}))}render(){const{props:{link:e,links:t,blockCreator:n}}=this;let{props:{blocks:o}}=this;return s.default.createElement("div",{className:"Chain__base_L0Lag"},s.default.createElement("svg",{onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart},t.map((e,t)=>((0,a.default)(["input","output"],t=>{const n=o.findIndex(n=>n.get("id")===e.getIn([t,"block"]));o=o.setIn([n,`${t}Pins`,e.getIn([t,"pin"]),"linked"],!0)}),s.default.createElement(h.default,{key:t,model:e}))),s.default.createElement(p.default,{model:e})),o.map(e=>{const t=e.get("id");return[s.default.createElement(l.default,{key:t,model:e}),e.get("inputPins").map(e=>s.default.createElement(_.default,{key:e.get("index"),model:e,parent:t,onMouseDownOrTouchStart:this.onConnectStart,onMouseUpOrTouchEnd:this.onConnectPin})),e.get("outputPins").map(e=>s.default.createElement(_.default,{key:e.get("index"),model:e,parent:t,onMouseDownOrTouchStart:this.onConnectStart,onMouseUpOrTouchEnd:this.onConnectPin}))]}),s.default.createElement(u.default,{model:n}))}}).prototype,"onConnectStart",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onConnectStart"),r.prototype),P(r.prototype,"onConnecting",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onConnecting"),r.prototype),P(r.prototype,"onConnectEnd",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onConnectEnd"),r.prototype),P(r.prototype,"onConnectPin",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onConnectPin"),r.prototype),P(r.prototype,"onMessage",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onMessage"),r.prototype),P(r.prototype,"onMouseDownOrTouchStart",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseDownOrTouchStart"),r.prototype),o=r))||o;t.default=E},455:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),r=m(o),a=n(48),i=m(n(452)),s=n(172),c=m(n(303)),l=n(121),u=n(262),d=m(n(290)),p=m(n(285)),h=m(n(30)),f=n(179),_=n(41),b=m(n(270));function m(e){return e&&e.__esModule?e:{default:e}}const{link:g,active:v}=b.default,y=(0,s.createStore)((0,l.enableBatching)(c.default));y.dispatch(h.default.addBlock({x:innerWidth/2+50,y:(innerHeight-_.BLOCK.HEIGHT)/2,type:_.BLOCK.TYPE_VIEW})),y.dispatch(h.default.addBlock({x:innerWidth/2-_.BLOCK.WIDTH-50,y:(innerHeight-_.BLOCK.HEIGHT)/2,type:_.BLOCK.TYPE_TIMER}));const P=()=>r.default.createElement(u.Redirect,{to:"/chain"});t.default=class extends o.Component{render(){return r.default.createElement(a.Provider,{store:y},r.default.createElement(u.HashRouter,null,r.default.createElement("div",{className:"App__wrap_1SQHV"},r.default.createElement("div",{className:"App__base_2Rw2G"},r.default.createElement(d.default,null),r.default.createElement(u.Route,{exact:!0,path:"/",render:P}),r.default.createElement(u.Route,{path:"/chain",component:i.default}),r.default.createElement(u.Route,{path:"/editor",component:p.default})),r.default.createElement("footer",null,r.default.createElement(u.NavLink,{to:"/chain",className:g,activeClassName:v},r.default.createElement("span",null,"Chain")),r.default.createElement(u.NavLink,{to:"/editor",className:g,activeClassName:v},r.default.createElement("span",null,"Editor")),r.default.createElement(u.NavLink,{to:"/view",className:g,activeClassName:v},r.default.createElement("span",null,"View"))),r.default.createElement(f.ToastContainer,{autoClose:3e3}))))}}},464:function(e,t,n){"use strict";var o=i(n(2)),r=n(80),a=i(n(455));function i(e){return e&&e.__esModule?e:{default:e}}n(268),n(266),n(264),(0,r.render)(o.default.createElement(a.default,null),document.querySelector("main"))},667:function(e,t,n){n(666),e.exports=n(464)},84:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PinLink=t.PointLink=t.BlockCreator=t.Pin=t.Block=void 0;var o=h(n(301)),r=h(n(25)),a=h(n(180)),i=h(n(196)),s=h(n(79)),c=h(n(77)),l=h(n(297)),u=n(85),d=n(41),p=h(n(120));function h(e){return e&&e.__esModule?e:{default:e}}const{white0:f,purple0:_,blue1:b,yellow0:m}=p.default;t.Block=class e extends((0,u.Record)({id:0,value:"",x:0,y:0,width:d.BLOCK.WIDTH,height:d.BLOCK.HEIGHT,deletable:!0,editable:!0,resizable:!0,type:"",color:f,changeable:!0,outputPins:(0,u.List)(),inputPins:(0,u.List)(),handwriting:d.EMPTY_HANDWRITING})){constructor(e){super(e);const{type:t}=this;let n=null;switch(t){case d.BLOCK.TYPE_VIEW:n={editable:!1,deletable:!1,color:_,inputPins:this._createPins([f],d.PIN.TYPE_INPUT)};break;case d.BLOCK.TYPE_VALUE:n={changeable:!1,outputPins:this._createPins([_],d.PIN.TYPE_OUTPUT)};break;case d.BLOCK.TYPE_FUNCTION:n={color:b,inputPins:this._createPins([b],d.PIN.TYPE_INPUT),outputPins:this._createPins([_],d.PIN.TYPE_OUTPUT)};break;case d.BLOCK.TYPE_PROPERTY:n={changeable:!1,color:m,inputPins:this._createPins([f],d.PIN.TYPE_INPUT),outputPins:this._createPins([f],d.PIN.TYPE_OUTPUT)};break;case d.BLOCK.TYPE_OPERATOR:n={changeable:!1,inputPins:this._createPins([f,f],d.PIN.TYPE_INPUT),outputPins:this._createPins([f],d.PIN.TYPE_OUTPUT)};break;case d.BLOCK.TYPE_MATH:n={changeable:!1,editable:!1,outputPins:this._createPins([f],d.PIN.TYPE_OUTPUT)};break;case d.BLOCK.TYPE_TIMER:n={changeable:!1,editable:!1,resizable:!1,outputPins:this._createPins([f],d.PIN.TYPE_OUTPUT),value:60};break;default:throw new Error(`Unknown type: ${t}.`)}return this.merge(n).recalculateHeight()}recalculateHeight(){const{type:e,height:t,inputPins:{size:n},outputPins:{size:o}}=this;let r=Math.max(t,Math.max(4,n+2,o+2)*(2*d.PIN.WIDTH+1)-1);return e!==d.BLOCK.TYPE_VIEW&&e!==d.BLOCK.TYPE_TIMER&&(r=Math.max(200,r)),this.set("height",r)}recalculatePinPosition(){const{inputPins:e,outputPins:t,x:n,y:o}=this;return this.merge({inputPins:e.map((e,t)=>{const[r,a]=this._pinPosition(t,d.PIN.TYPE_INPUT);return e.merge({cx:n+r,cy:o+a})}),outputPins:t.map((e,t)=>{const[r,a]=this._pinPosition(t,d.PIN.TYPE_OUTPUT);return e.merge({cx:n+r,cy:o+a})})})}dmove(e,t){const{x:n,y:o,inputPins:r,outputPins:a}=this;return this.merge({x:n+e,y:o+t,inputPins:r.map(n=>n.dmove(e,t)),outputPins:a.map(n=>n.dmove(e,t))})}dresize(e,t){const{type:n,width:o,height:r}=this;return this.merge({width:Math.max(d.BLOCK.WIDTH,o+e),height:Math.max(n!==d.BLOCK.TYPE_VIEW?200:d.BLOCK.HEIGHT,r+t)}).recalculatePinPosition()}createPin(t,n,o=null){const{x:r,y:a}=this,i=e.convertPinTypeToPinKey(n),{size:s}=this.get(i),c=(0,l.default)(o)?s:o,[u,d]=this._pinPosition(c,n);return new g({index:c,color:t,type:n,cx:r+u,cy:a+d})}_createPins(t,n){const o=this.get(e.convertPinTypeToPinKey(n));return 0===o.size?(0,u.List)((0,c.default)(t,(e,t)=>this.createPin(e,n,t))):o}_pinPosition(e,t){const{width:n}=this;return[t===d.PIN.TYPE_INPUT?-d.PIN.RADIUS-2:t===d.PIN.TYPE_OUTPUT?n+d.PIN.RADIUS:0,21+d.PIN.RADIUS+(2*d.PIN.WIDTH+1)*e+1]}static convertPinTypeToPinKey(e){switch(e){case d.PIN.TYPE_OUTPUT:return"outputPins";case d.PIN.TYPE_INPUT:return"inputPins";default:throw new Error("Unknown pin type")}}};let g=t.Pin=class extends((0,u.Record)({index:0,color:f,type:"",linked:!1,cx:0,cy:0})){dmove(e,t){const{cx:n,cy:o}=this;return this.merge({cx:n+e,cy:o+t})}};t.BlockCreator=class extends((0,u.Record)({x:0,y:0,visible:!1,value:"",selected:d.BLOCK.TYPE_VALUE})){show(e,t){return this.merge({visible:!0,x:e,y:t,value:"",selected:d.BLOCK.TYPE_VALUE})}},t.PointLink=class extends((0,u.Record)({ax:0,ay:0,bx:0,by:0})){start(e,t){return this.merge({ax:e,ay:t,bx:e,by:t})}end(e,t){return this.merge({bx:e,by:t})}points(){const{ax:e,ay:t,bx:n,by:o}=this;return[e,t,n,o]}},t.PinLink=class e extends((0,u.Record)({output:(0,u.Map)({block:0,pin:0}),input:(0,u.Map)({block:0,pin:0})})){constructor(e){(0,s.default)(["output","input"],t=>{(0,i.default)(e,t)&&(e[t]=(0,u.Map)(e[t]))}),super(e)}hasBlock(e){return(0,a.default)(["output","input"],t=>this.getIn([t,"block"])===e)}match({output:t,input:n}){return e._matcher(this.get("output"),t)&&e._matcher(this.get("input"),n)}static _matcher(t,n){return(0,r.default)(n)?!(0,a.default)((0,o.default)(n),([n,o])=>!e._matcher(t.get(n),o)):void 0!==t&&(void 0===n||t===n)}}},88:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TemporaryUserSelectNone=t.generator=t.getMouseOrFirstTouchPosition=t.cosineCurvePoints=t.dist=void 0;var o=i(n(77)),r=i(n(367)),a=i(n(186));function i(e){return e&&e.__esModule?e:{default:e}}const s=t.dist=((e,t,n,o)=>Math.sqrt(Math.pow(e-n,2)+Math.pow(t-o,2)));t.cosineCurvePoints=((e,t,n,o,r=10)=>{const a=s(e,t,n,o);if(0===a)return[];const i=(n-e)/a,c=o-t,l=[];for(let u=0;u<=a;u+=1){const d=e+i*u,p=t+c*(1-Math.cos(Math.PI/a*u))/2;r<s(e,t,d,p)&&r<s(n,o,d,p)&&l.push(d,p)}return l}),t.getMouseOrFirstTouchPosition=(e=>{const{type:t,changedTouches:n}=e;if((0,a.default)(["mousedown","mousemove","mouseup"],t))return e;if((0,a.default)(["touchstart","touchmove","touchend"],t))return n.item(0);throw new Error("Unknown event type")}),t.generator=new class e{static get ZEROS_42(){return"000000000000000000000000000000000000000000"}static get ZEROS_12(){return"000000000000"}constructor(){this.sequence=0,this.ptime=0}id(){const t=Date.now();t===this.ptime?this.sequence+=1:this.sequence=0;const n=(e.ZEROS_42+(t-1288834974657).toString(2)).slice(-42),o=(e.ZEROS_12+this.sequence.toString(2)).slice(-12);return(0,r.default)(`${n}${o}`,2)}};t.TemporaryUserSelectNone=class{constructor(){this._all=[]}search(e=document){this._all=[...e.querySelectorAll("textarea"),...e.querySelectorAll("input")],this.add()}add(){const{_all:e}=this;(0,o.default)(e,e=>e.classList.add("user-select-none"))}remove(){const{_all:e}=this;(0,o.default)(e,e=>e.classList.remove("user-select-none"))}}}});