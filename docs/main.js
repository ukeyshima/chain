!function(e){function t(t){for(var o,i,c=t[0],s=t[1],l=t[2],d=0,p=[];d<c.length;d++)i=c[d],r[i]&&p.push(r[i][0]),r[i]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);for(u&&u(t);p.length;)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,c=1;c<n.length;c++){var s=n[c];0!==r[s]&&(o=!1)}o&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={1:0};var a=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="http://localhost:3000/";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=s;a.push([677,0]),n()}({184:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(2)),r=n(88),a=i(n(86));function i(e){return e&&e.__esModule?e:{default:e}}const{white0:c}=a.default;t.default=(e=>{const{points:t,strokeDasharray:n}=e;return o.default.createElement("polyline",{points:(0,r.cosineCurvePoints)(...t),fill:"none",stroke:c,strokeWidth:3,strokeDasharray:n})})},190:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=u(n(369)),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i=n(2),c=u(i),s=u(n(69)),l=u(n(68));function u(e){return e&&e.__esModule?e:{default:e}}let d=(p=(o=class extends i.Component{constructor(){super(),this.tab=!1,this.selectionStart=-1}componentDidUpdate(){const{selectionStart:e}=this;if(-1<e){const t=e+1;s.default.findDOMNode(this).setSelectionRange(t,t)}this.selectionStart=-1}onKeyDown(...e){const{props:{onKeyDown:t}}=this,{keyCode:n,currentTarget:{selectionStart:o}}=e[0];9===n&&(this.selectionStart=o),"function"==typeof t&&t(...e)}render(){const{props:e}=this,t=(0,r.default)(e);return delete t.onKeyDown,c.default.createElement("textarea",a({},t,{onKeyDown:this.onKeyDown}))}}).prototype,h="onKeyDown",f=[l.default],b=Object.getOwnPropertyDescriptor(o.prototype,"onKeyDown"),_=o.prototype,g={},Object.keys(b).forEach(function(e){g[e]=b[e]}),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=f.slice().reverse().reduce(function(e,t){return t(p,h,e)||e},g),_&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(_):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(p,h,g),g=null),o);var p,h,f,b,_,g;t.default=d},271:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,"html,\nbody,\nmain {\n  width: 100%;\n  height: 100%; }\n\nbody {\n  margin: 0;\n  font-family: sans-serif; }\n  body.index__cursor-move_3IF2O * {\n    cursor: move; }\n\n.ReactCodeMirror {\n  height: 100%; }\n\n.CodeMirror {\n  height: 100%; }\n",""]),t.locals={"cursor-move":"index__cursor-move_3IF2O"}},272:function(e,t,n){var o=n(271);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(23)(o,r);o.locals&&(e.exports=o.locals)},273:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,"body {\n  box-sizing: border-box; }\n\n.App__wrap_1SQHV {\n  width: 100%;\n  height: 100%;\n  background-color: #1e1e1e; }\n  .App__wrap_1SQHV footer {\n    position: fixed;\n    left: 0;\n    bottom: 0;\n    width: 100%;\n    border-top: 1px solid #2b2b2b;\n    color: #d4d4d4;\n    background-color: #1e1e1e; }\n\n.App__base_2Rw2G {\n  width: 100%;\n  height: calc(100% - 36px); }\n\n.App__link_36M0v {\n  font-weight: 100;\n  padding: 5px 10px;\n  color: #555555;\n  display: inline-block;\n  text-decoration: none; }\n  .App__link_36M0v > span {\n    padding: 3px 6px;\n    display: inline-block;\n    border-bottom: 1px transparent solid; }\n\n.App__active_3QbdL {\n  color: #d4d4d4; }\n  .App__active_3QbdL > span {\n    border-bottom-color: #007acc; }\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",blockWidth:"200px",wrap:"App__wrap_1SQHV",base:"App__base_2Rw2G",link:"App__link_36M0v",active:"App__active_3QbdL"}},274:function(e,t,n){var o=n(273);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(23)(o,r);o.locals&&(e.exports=o.locals)},289:function(e,t,n){"use strict";var o,r;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(2),i=d(a),c=n(49),s=d(n(30)),l=d(n(288));n(283),n(281),n(279),n(275);var u=d(n(68));function d(e){return e&&e.__esModule?e:{default:e}}let p=(0,c.connect)(({htmlEditor:e})=>({code:e}))((h=(r=class extends a.Component{onChange(e){const{props:{dispatch:t}}=this;t(s.default.onChangeHtml(e))}render(){const{props:{code:e}}=this;return i.default.createElement(l.default,{value:e,onChange:this.onChange,options:{mode:"htmlmixed",theme:"monokai",styleActiveLine:!0,lineNumbers:!0}})}}).prototype,f="onChange",b=[u.default],_=Object.getOwnPropertyDescriptor(r.prototype,"onChange"),g=r.prototype,m={},Object.keys(_).forEach(function(e){m[e]=_[e]}),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=b.slice().reverse().reduce(function(e,t){return t(h,f,e)||e},m),g&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(g):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(h,f,m),m=null),o=r))||o;var h,f,b,_,g,m;t.default=p},290:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,".HTMLRenderer__base_y4ZXu {\n  display: block;\n  width: 100%;\n  height: 100%;\n  border: none;\n  background-color: white;\n  position: absolute;\n  left: 0;\n  top: 0; }\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",blockWidth:"200px",base:"HTMLRenderer__base_y4ZXu"}},291:function(e,t,n){var o=n(290);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(23)(o,r);o.locals&&(e.exports=o.locals)},294:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=p(n(98)),a=p(n(293)),i=p(n(79)),c=p(n(292)),s=n(2),l=p(s),u=n(49),d=n(41);function p(e){return e&&e.__esModule?e:{default:e}}n(291);const h=new DOMParser;let f=(0,u.connect)(({blocks:e,pinLinks:t,htmlEditor:n})=>({blocks:e,links:t,html:n}))(o=class extends s.Component{toEvalableString(){const{props:{blocks:e}}=this,t=e.first();return t?this.toEvalableStringSub(t.get("id")):null}toEvalableStringSub(e){if(null===e)return"null";const{props:{blocks:t}}=this,n=t.find(t=>t.get("id")===e),o=n.get("inputPins").map(t=>this.toEvalableStringSub(this.findOutputBlockIdFromLinks({input:{block:e,pin:t.get("index")}}))).toJS();switch(n.get("type")){case d.BLOCK.TYPE_VIEW:return o;case d.BLOCK.TYPE_VALUE:return n.get("value");case d.BLOCK.TYPE_FUNCTION:const[e,...t]=o,r=`(${(0,c.default)(t,", ")})`;return e?`${e}[${JSON.stringify(n.get("value"))}]${r}`:`${n.get("value")}${r}`;case d.BLOCK.TYPE_PROPERTY:return`${o[0]}[${JSON.stringify(n.get("value"))}]`;case d.BLOCK.TYPE_OPERATOR:return`(${o[0]}${n.get("value")}${o[1]})`;case d.BLOCK.TYPE_MATH:const{expression:s,args:l,flattenArgs:u}=n.get("handwriting");let p="",h=0;return(0,i.default)(l,({char:e,index:t})=>{p+=s.substring(h,t)+o[(0,a.default)(u,e)],h=t+1}),`(${p+=s.slice(h)})`;default:return'"UNKNOWN_BLOCK"'}}findOutputBlockIdFromLinks(e){const{props:{links:t}}=this;let n=null;return t.some(t=>!!t.match(e)&&(n=t.getIn(["output","block"]),!0)),n}render(){const{props:{html:e}}=this,t=h.parseFromString(e,"text/html"),n=t.querySelector("body"),o=document.createElement("script"),a=(0,c.default)((0,r.default)(this.toEvalableString(),e=>`parent.postMessage({ type: 'chain-result', value: ${e} }, '*')`),"\n");return o.innerHTML=`\n\t\t\tparent.postMessage({ type: 'chain-clear' }, '*');\n\t\t\ttry {\n\t\t\t\t(0, eval)(${JSON.stringify(a)});\n\t\t\t} catch (err) {\n\t\t\t\tparent.postMessage({ type: 'chain-error', value: String(err) }, '*');\n\t\t\t}\n\t\t`,n.appendChild(o),l.default.createElement("iframe",{srcDoc:`<!doctype html>${t.documentElement.outerHTML}`,className:"HTMLRenderer__base_y4ZXu"})}})||o;t.default=f},296:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(66),a=n(30),i=(o=a)&&o.__esModule?o:{default:o};t.default=(0,r.handleActions)({[i.default.onChangeHtml]:(e,t)=>{const{payload:n}=t;return n}},'<!doctype html>\n<html>\n<head>\n\t<meta charset="utf-8" />\n</head>\n<body>\n\t<h1>Hello, World!</h1>\n</body>\n</html>\n')},297:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(121),a=n(83),i=n(66),c=n(30),s=(o=c)&&o.__esModule?o:{default:o};t.default=(0,i.handleActions)({[s.default.addPinLink]:(e,t)=>{const{payload:n}=t,o={input:n.input};return e.filter(e=>!e.match(o)).push(new a.PinLink(n))},[s.default.deleteBlock]:(e,t)=>{const{payload:n}=t;return e.filter(e=>!e.hasBlock(n))},[s.default.removePinLinkByQuery]:(e,t)=>{const{payload:n}=t;return e.filter(e=>!e.match(n))},[s.default.deletePin]:(e,t)=>{const{payload:{id:n,removed:o}}=t;return 0===o?e:e.filter(e=>!e.match({input:{block:n,pin:o}}))}},(0,r.List)())},298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(83),a=n(66),i=n(30),c=(o=i)&&o.__esModule?o:{default:o};t.default=(0,a.handleActions)({[c.default.startPointLink]:(e,t)=>{const{payload:{x:n,y:o}}=t;return e.start(n,o)},[c.default.endPointLink]:(e,t)=>{const{payload:{x:n,y:o}}=t;return e.end(n,o)}},new r.PointLink)},299:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(83),a=n(66),i=n(30),c=(o=i)&&o.__esModule?o:{default:o};t.default=(0,a.handleActions)({[c.default.updateBlockCreator]:(e,t)=>{const{payload:n}=t;return e.merge(n)},[c.default.showBlockCreator]:(e,t)=>{const{payload:{x:n,y:o}}=t;return e.show(n,o)}},new r.BlockCreator)},30:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(394),a=(o=r)&&o.__esModule?o:{default:o},i=n(66),c=n(88);t.default=(0,i.createActions)({ADD_BLOCK:e=>(0,a.default)({id:c.generator.id()},e),UPDATE_BLOCK:(e,t)=>({id:e,patch:t}),DELTA_MOVE_BLOCK:(e,t,n)=>({id:e,dx:t,dy:n}),TOGGLE_BLOCK_CREATOR:(e,t)=>({x:e,y:t})},"DELETE_BLOCK","UPDATE_BLOCK_CREATOR","ADD_PIN","DELETE_PIN","START_POINT_LINK","END_POINT_LINK","ADD_PIN_LINK","REMOVE_PIN_LINK_BY_QUERY","ON_CHANGE_HTML","CLEAR_VIEW_BLOCK","PUSH_VIEW_BLOCK","SHOW_BLOCK_CREATOR","UPDATE_HANDWRITING")},306:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=u(n(305)),r=n(121),a=n(83),i=n(66),c=u(n(30)),s=n(41),l=u(n(86));function u(e){return e&&e.__esModule?e:{default:e}}const{blue2:d,white0:p}=l.default;t.default=(0,i.handleActions)({[c.default.addBlock]:(e,t)=>{const{payload:n}=t;return e.push(new a.Block(n))},[c.default.updateBlock]:(e,t)=>{const{payload:{id:n,patch:o}}=t,r=e.findIndex(e=>e.get("id")===n);return e.update(r,e=>e.merge(o).set("handwriting",s.EMPTY_HANDWRITING))},[c.default.deleteBlock]:(e,t)=>{const{payload:n}=t,o=e.findIndex(e=>e.get("id")===n);return e.filter((e,t)=>t!==o)},[c.default.deltaMoveBlock]:(e,t)=>{const{payload:{id:n,dx:o,dy:r}}=t,a=e.findIndex(e=>e.get("id")===n);return e.update(a,e=>e.dmove(o,r))},[c.default.addPin]:(e,t)=>{const{payload:n}=t,o=e.findIndex(e=>e.get("id")===n);return e.update(o,e=>e.updateIn(["inputPins"],t=>t.push(e.createPin(e.type===s.BLOCK.TYPE_FUNCTION?d:p,s.PIN.TYPE_INPUT))).recalculateHeight())},[c.default.deletePin]:(e,t)=>{const{payload:{id:n}}=t,o=e.findIndex(e=>e.get("id")===n);return e.update(o,e=>e.updateIn(["inputPins"],e=>e.slice(0,Math.max(1,e.size-1))).recalculateHeight())},[c.default.clearViewBlock]:e=>e.update(0,e=>e.set("value","")),[c.default.pushViewBlock]:(e,t)=>{const{payload:n}=t;return e.update(0,e=>{const t=e.get("value");return e.set("value",t?`${t}\n${n}`:n)})},[c.default.updateHandwriting]:(e,t)=>{const{payload:{id:n,handwriting:r}}=t,a=e.findIndex(e=>e.get("id")===n),{flattenArgs:{length:i},expression:c}=r;return e.update(a,e=>{if(e.get("type")===s.BLOCK.TYPE_MATH){e=e.updateIn(["inputPins"],e=>e.clear());for(let t=0;t<i;t+=1)e=e.updateIn(["inputPins"],t=>t.push(e.createPin(p,s.PIN.TYPE_INPUT)))}return e=e.set("handwriting",r),(0,o.default)(r,s.EMPTY_HANDWRITING)||(e=e.set("value",c)),e})}},(0,r.List)())},307:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(175),r=l(n(306)),a=l(n(299)),i=l(n(298)),c=l(n(297)),s=l(n(296));function l(e){return e&&e.__esModule?e:{default:e}}t.default=(0,o.combineReducers)({blocks:r.default,blockCreator:a.default,pointLink:i.default,pinLinks:c.default,htmlEditor:s.default})},308:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,".Chain__base_L0Lag {\n  background-color: #1e1e1e;\n  position: relative;\n  width: 100%;\n  height: 100%; }\n  .Chain__base_L0Lag > svg {\n    display: block;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    left: 0;\n    top: 0; }\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",blockWidth:"200px",base:"Chain__base_L0Lag"}},309:function(e,t,n){var o=n(308);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(23)(o,r);o.locals&&(e.exports=o.locals)},322:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=d(n(321)),a=d(n(43)),i=d(n(183)),c=n(2),s=d(c),l=n(41),u=d(n(68));function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t,n,o,r){var a={};return Object.keys(o).forEach(function(e){a[e]=o[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}const h=l.PIN.RADIUS+1;let f=(p((o=class extends c.Component{constructor(){super(),this.state={enter:!1,connecting:!1}}onMouseDownOrTouchStart(e){const{props:{model:t,parent:n,onMouseDownOrTouchStart:o}}=this;o(e,t,n),document.addEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.addEventListener("touchend",this.onMouseUpOrTouchEndDocument),this.setState({connecting:!0})}onMouseup(e){const{props:{model:t,onMouseUpOrTouchEnd:n,parent:o}}=this;n(e,t,o)}onMouseEnter(){this.setState({enter:!0})}onMouseLeave(){this.setState({enter:!1})}onTouchEnd(e){const{pageX:t,pageY:n}=e.changedTouches.item(0);(0,i.default)(document.querySelectorAll("[data-pin]"),o=>{const{left:c,top:s,width:l,height:u}=o.getBoundingClientRect();return c<=t&&t<=c+l&&s<=n&&n<=s+u&&((0,i.default)((0,a.default)(o),t=>{if((0,r.default)(t,"__reactInternalInstance$")){const{_currentElement:{_owner:{_currentElement:{props:{model:n,onMouseUpOrTouchEnd:r,parent:a}}}}}=o[t];return r(e,n,a),!0}return!1}),!0)})}onMouseUpOrTouchEndDocument(){document.removeEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.removeEventListener("touchend",this.onMouseUpOrTouchEndDocument),this.setState({connecting:!1})}render(){const{props:{model:e},state:{enter:t,connecting:n}}=this,o=e.get("color"),r=e.get("type");return s.default.createElement("svg",{"data-pin":!0,onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart,onMouseUp:this.onMouseup,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onTouchEnd:this.onTouchEnd,style:{position:"absolute",left:e.get("cx")-h,top:e.get("cy")-h,width:2*l.PIN.WIDTH,height:2*l.PIN.WIDTH,cursor:"pointer"}},s.default.createElement("circle",{cx:h,cy:h,r:l.PIN.S_RADIUS,fill:r===l.PIN.TYPE_INPUT?"none":r===l.PIN.TYPE_OUTPUT?o:"red",stroke:o}),t||n||e.get("linked")?s.default.createElement("circle",{cx:h,cy:h,r:l.PIN.RADIUS,fill:"none",stroke:o}):null)}}).prototype,"onMouseDownOrTouchStart",[u.default],Object.getOwnPropertyDescriptor(o.prototype,"onMouseDownOrTouchStart"),o.prototype),p(o.prototype,"onMouseup",[u.default],Object.getOwnPropertyDescriptor(o.prototype,"onMouseup"),o.prototype),p(o.prototype,"onMouseEnter",[u.default],Object.getOwnPropertyDescriptor(o.prototype,"onMouseEnter"),o.prototype),p(o.prototype,"onMouseLeave",[u.default],Object.getOwnPropertyDescriptor(o.prototype,"onMouseLeave"),o.prototype),p(o.prototype,"onTouchEnd",[u.default],Object.getOwnPropertyDescriptor(o.prototype,"onTouchEnd"),o.prototype),p(o.prototype,"onMouseUpOrTouchEndDocument",[u.default],Object.getOwnPropertyDescriptor(o.prototype,"onMouseUpOrTouchEndDocument"),o.prototype),o);t.default=f},323:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=l(n(79)),a=n(2),i=l(a),c=n(49),s=l(n(184));function l(e){return e&&e.__esModule?e:{default:e}}let u=(0,c.connect)(({blocks:e})=>({blocks:e}))(o=class extends a.Component{render(){const{props:{blocks:e,model:t}}=this,n=[];return(0,r.default)(["output","input"],o=>{const r=e.find(e=>e.get("id")===t.getIn([o,"block"])).getIn([`${o}Pins`,t.getIn([o,"pin"])]);n.push(r.get("cx"),r.get("cy"))}),i.default.createElement(s.default,{points:n})}})||o;t.default=u},324:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(2)),r=a(n(184));function a(e){return e&&e.__esModule?e:{default:e}}t.default=(e=>{const{model:t}=e;return o.default.createElement(r.default,{points:t.points(),strokeDasharray:[5,5]})})},325:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,'.BlockCreator__shadow_Y8igC, .BlockCreator__base_1ZSFp {\n  box-shadow: 0 3px 3px 0 rgba(0, 0, 0, 0.14), 0 1px 7px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -1px rgba(0, 0, 0, 0.2); }\n\n.BlockCreator__base_1ZSFp {\n  background-color: #1e1e1e;\n  border: 1px solid #2b2b2b;\n  color: #d4d4d4;\n  width: 200px;\n  padding: 10px;\n  box-sizing: border-box;\n  font-family: Menlo, Monaco, "Courier New", monospace;\n  font-size: 12px; }\n  .BlockCreator__base_1ZSFp select {\n    display: block;\n    background-color: #2b2b2b;\n    color: inherit;\n    width: 100%;\n    border: 1px solid transparent;\n    margin-bottom: 5px;\n    font: inherit;\n    outline: none;\n    -webkit-appearance: none;\n    padding: 2px 4px; }\n    .BlockCreator__base_1ZSFp select:focus {\n      border-color: #007acc; }\n  .BlockCreator__base_1ZSFp textarea {\n    width: 100%;\n    background-color: #2b2b2b;\n    font: inherit;\n    color: inherit;\n    height: 100%;\n    box-sizing: border-box;\n    resize: vertical;\n    outline: none;\n    display: block;\n    margin-bottom: 5px;\n    border: 1px solid transparent;\n    border-radius: 0; }\n    .BlockCreator__base_1ZSFp textarea:focus {\n      border-color: #007acc; }\n  .BlockCreator__base_1ZSFp button {\n    display: inline-block;\n    background-color: #2b2b2b;\n    color: inherit;\n    border-radius: 4px;\n    font: inherit;\n    border: none;\n    outline: none;\n    cursor: pointer; }\n',""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",blockWidth:"200px",shadow:"BlockCreator__shadow_Y8igC",base:"BlockCreator__base_1ZSFp"}},326:function(e,t,n){var o=n(325);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(23)(o,r);o.locals&&(e.exports=o.locals)},345:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r,a=m(n(344)),i=m(n(338)),c=m(n(185)),s=m(n(98)),l=n(2),u=m(l),d=n(69),p=n(49),h=m(n(30)),f=n(41),b=n(122),_=m(n(68)),g=m(n(190));function m(e){return e&&e.__esModule?e:{default:e}}function v(e,t,n,o,r){var a={};return Object.keys(o).forEach(function(e){a[e]=o[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}n(326);const y=[f.BLOCK.TYPE_VALUE,f.BLOCK.TYPE_FUNCTION,f.BLOCK.TYPE_PROPERTY,f.BLOCK.TYPE_OPERATOR,f.BLOCK.TYPE_MATH],P=(0,s.default)(y,e=>(0,c.default)((0,i.default)(e.toString())));let E=(0,p.connect)()((v((r=class extends l.Component{componentWillUpdate(e){const{model:t}=e,{props:{model:n}}=this;!n.get("visible")&&t.get("visible")&&(document.addEventListener("mousedown",this.onMouseDownOrTouchStartDocument),document.addEventListener("touchstart",this.onMouseDownOrTouchStartDocument))}onClick(){const{props:{model:e,dispatch:t}}=this;document.removeEventListener("mousedown",this.onMouseDownOrTouchStartDocument),document.removeEventListener("touchstart",this.onMouseDownOrTouchStartDocument),t((0,b.batchActions)([h.default.addBlock({x:e.get("x"),y:e.get("y"),value:(0,a.default)(e.get("value")),type:e.get("selected")}),h.default.updateBlockCreator({visible:!1})]))}onChangeTextarea(e){const{currentTarget:{value:t}}=e,{props:{dispatch:n}}=this;n(h.default.updateBlockCreator({value:t}))}onChangeSelect(e){const{currentTarget:{value:t}}=e,{props:{dispatch:n}}=this;n(h.default.updateBlockCreator({selected:t}))}onMouseDownOrTouchStartDocument(e){const{target:t}=e,{props:{dispatch:n}}=this,o=(0,d.findDOMNode)(this);o&&!o.contains(t)&&(n(h.default.updateBlockCreator({visible:!1})),document.removeEventListener("mousedown",this.onMouseDownOrTouchStartDocument),document.removeEventListener("touchstart",this.onMouseDownOrTouchStartDocument))}onKeyDown(e){const{keyCode:t,currentTarget:{selectionStart:n,selectionEnd:o}}=e,{props:{dispatch:r,model:a}}=this;if(9===t){e.preventDefault();const t=a.get("value");r(h.default.updateBlockCreator({value:`${t.substring(0,n)}\t${t.substring(o)}`}))}}render(){const{props:{model:e}}=this;return e.get("visible")?u.default.createElement("div",{className:"BlockCreator__base_1ZSFp",style:{position:"absolute",left:e.get("x"),top:e.get("y")}},u.default.createElement("select",{value:e.get("selected"),onChange:this.onChangeSelect},(0,s.default)(y,(e,t)=>u.default.createElement("option",{value:e,key:t},P[t]))),u.default.createElement(g.default,{onChange:this.onChangeTextarea,value:e.get("value"),spellCheck:!1,onKeyDown:this.onKeyDown}),u.default.createElement("button",{onClick:this.onClick},"ADD")):null}}).prototype,"onClick",[_.default],Object.getOwnPropertyDescriptor(r.prototype,"onClick"),r.prototype),v(r.prototype,"onChangeTextarea",[_.default],Object.getOwnPropertyDescriptor(r.prototype,"onChangeTextarea"),r.prototype),v(r.prototype,"onChangeSelect",[_.default],Object.getOwnPropertyDescriptor(r.prototype,"onChangeSelect"),r.prototype),v(r.prototype,"onMouseDownOrTouchStartDocument",[_.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseDownOrTouchStartDocument"),r.prototype),v(r.prototype,"onKeyDown",[_.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyDown"),r.prototype),o=r))||o;t.default=E},346:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,'.Block__shadow_2-4hx, .Block__base_3ulp8 {\n  box-shadow: 0 3px 3px 0 rgba(0, 0, 0, 0.14), 0 1px 7px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -1px rgba(0, 0, 0, 0.2); }\n\n.Block__base_3ulp8 {\n  font-size: 12px;\n  color: #d4d4d4;\n  border: 1px solid #2b2b2b;\n  background-color: #1e1e1e;\n  box-sizing: border-box;\n  font-family: Menlo, Monaco, "Courier New", monospace;\n  width: 200px;\n  display: flex;\n  flex-direction: column; }\n  .Block__base_3ulp8 button {\n    display: inline-block;\n    text-decoration: none;\n    color: inherit;\n    border: none;\n    font: inherit;\n    padding: 1px 8px;\n    outline: none;\n    cursor: pointer;\n    background-color: #2b2b2b;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    margin: 0; }\n    .Block__base_3ulp8 button:not(:first-of-type) {\n      margin-left: 1px; }\n  .Block__base_3ulp8 textarea {\n    width: 100%;\n    border: none;\n    background-color: #2b2b2b;\n    font: inherit;\n    color: inherit;\n    height: 100%;\n    box-sizing: border-box;\n    resize: vertical;\n    outline: none;\n    display: block;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    border-radius: 0; }\n\n.Block__math_2WDqM {\n  background-color: #2b2b2b;\n  height: calc(100% - 21px);\n  width: 100%; }\n\n.Block__math-arg_3aTuw {\n  position: absolute;\n  background-color: #2b2b2b;\n  width: 20px;\n  left: 2px;\n  text-align: center; }\n\n.Block__textarea-div_19vCU, .Block__math-div_2fcEH {\n  height: calc(100% - 16px);\n  padding: 5px;\n  box-sizing: border-box;\n  position: relative; }\n  .Block__textarea-div_19vCU input, .Block__math-div_2fcEH input {\n    border: none;\n    background-color: #2b2b2b;\n    font-size: inherit;\n    color: #d4d4d4;\n    width: 100%;\n    outline: none;\n    box-sizing: border-box;\n    margin-bottom: 5px;\n    font-family: Menlo, Monaco, "Courier New", monospace; }\n\n.Block__math-div_2fcEH {\n  padding-left: 24px; }\n\n.Block__red_1kUYK {\n  background-color: #f44336 !important; }\n\n.ms-editor .loader {\n  width: 100px !important;\n  height: 100px !important;\n  top: calc(50% - 65px) !important;\n  left: calc(50% - 65px) !important; }\n\n#pendingStrokes * {\n  color: red !important; }\n\n#MODEL-viewTransform {\n  stroke: #d4d4d4; }\n',""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",blockWidth:"200px",shadow:"Block__shadow_2-4hx",base:"Block__base_3ulp8",math:"Block__math_2WDqM","math-arg":"Block__math-arg_3aTuw","textarea-div":"Block__textarea-div_19vCU","math-div":"Block__math-div_2fcEH",red:"Block__red_1kUYK"}},347:function(e,t,n){var o=n(346);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(23)(o,r);o.locals&&(e.exports=o.locals)},348:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(191)),r=a(n(79));function a(e){return e&&e.__esModule?e:{default:e}}var i,c,s,l,u,d,p,h,f,b,_;t.default=(e=>{const t=(e=e,c=function(){var t=e;return t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\s/g,"")).replace(/\\times/g,"*")).replace(/\\cdot/g,"*")).replace(/\\div/g,"/")).replace(/([0-9]+)([a-zA-Z]+)/g,"$1*$2")).replace(/([0-9a-zA-Z\.]+)\\pi/g,"$1*Math.PI")).replace(/\\pi([0-9a-zA-Z\.]+)/g,"Math.PI*$1")).replace(/([0-9a-zA-Z\.]+)\\pi([0-9a-zA-Z\.]+)/g,"$1*Math.PI*$2")).replace(/\\pi/g,"Math.PI"),t=s(t),t=l(t),t=u(t),t=d(t),t=p(t),t=f(t),t=(t=(t=(t=(t=(t=h(t)).replace(/\\left\(/g,"(")).replace(/\\right\)/g,")")).replace(/([0-9a-zA-Z\.]+)\Math/g,"$1*Math")).replace(/\)Math/g,")*Math")).replace(/\)([0-9a-zA-Z\.]+)/g,")*$1")},s=function(e){for(;e.search(/\\frac\{(((?![\{\}]).)*)\}\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\frac\{(((?![\{\}]).)*)\}\{(((?![\{\}]).)*)\}/g,"($1)/($3)");for(;e.search(/\\dfrac\{(((?![\{\}]).)*)\}\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\dfrac\{(((?![\{\}]).)*)\}\{(((?![\{\}]).)*)\}/g,"($1)/($3)");return e.search(/\\frac/)>=0&&(e=_("fraction",e)),e.search(/\\dfrac/)>=0&&(e=_("fraction",e)),e},l=function(e){for(;e.search(/\\sqrt\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\sqrt\{(((?![\{\}]).)*)\}/g,"Math.sqrt($1)");return e.search(/\\sqrt\{/)>=0&&(e=_("square root",e)),e},u=function(e){for(;e.search(/\\sqrt\[(((?![\{\}]).)*)\]\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\sqrt\[(((?![\{\}]).)*)\]\{(((?![\{\}]).)*)\}/g,"Math.pow($3,1/$1)");return e.search(/\\sqrt\[/)>=0&&(e=_("nth root",e)),e},d=function(e){for(;e.search(/([0-9a-zA-Z\.]+)\^\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/([0-9a-zA-Z\.]+)\^\{(((?![\{\}]).)*)\}/g,"Math.pow($1,$2)");for(;e.search(/([0-9a-zA-Z\.]+)\^([0-9a-zA-Z\.]+)/)>=0;)e=e.replace(/([0-9a-zA-Z\.]+)\^([0-9a-zA-Z\.]+)/g,"Math.pow($1,$2)");for(;e.search(/\\left\(([0-9a-zA-Z\.\+\*\-\\]+)\\right\)\^([0-9a-zA-Z\.]+)/)>=0;)e=e.replace(/\\left\(([0-9a-zA-Z\.\+\*\-\\]+)\\right\)\^([0-9a-zA-Z\.]+)/g,"Math.pow($1,$2)");for(;e.search(/\\left\(([0-9a-zA-Z\.\+\*\-\\]+)\\right\)\^\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\left\(([0-9a-zA-Z\.\+\*\-\\]+)\\right\)\^\{(((?![\{\}]).)*)\}/g,"Math.pow($1,$2)");for(;e.search(/\\left\(([0-9a-zA-Z\.\+\*\-\\\(\)\/]+)\\right\)\^\{(((?![\{\}]).)*)\}/)>=0;)e=e.replace(/\\left\(([0-9a-zA-Z\.\+\*\-\\\(\)\/]+)\\right\)\^\{(((?![\{\}]).)*)\}/g,"Math.pow($1,$2)");return e.search(/\^/)>=0&&(e=_("nth power",e)),e},p=function(e){return b("sin",e)},f=function(e){return b("tan",e)},h=function(e){return b("cos",e)},b=function(e,t){for(var n=/\\sin\\left\(([0-9a-zA-Z\.\+\*\-\\\(\)\/]+)\\right\)/;t.search(n)>=0;)t=t.replace(n,"Math."+e+"($1)");for(var o=new RegExp("\\\\"+e+"([0-9a-zA-Z]+)");t.search(o)>=0;)t=t.replace(o,"Math."+e+"($1)");var r=new RegExp("\\\\"+e);return t.search(r)>=0&&(t=_(e,t)),t},_=function(e,t){var n,o,r,a,i,c,b,_,g,m;switch(e){case"fraction":(n=t.match(/\\frac.*/)[0]).search(/\\frac/);break;case"square root":(n=t.match(/\\sqrt\{.*/)[0]).search(/\\sqrt\{/);break;case"nth root":(n=t.match(/\\sqrt\[.*/)[0]).search(/\\sqrt\[/);break;case"nth power":(n=t.match(/\^.*/)[0]).search(/\^/);break;case"sin":console.log(t),console.log(t.match(/\\sin\{.*/)),(n=t.match(/\\sin\{.*/)[0]).search(/\\sin\{/);break;case"tan":(n=t.match(/\\tan\{.*/)[0]).search(/\\tan\{/);break;case"cos":(n=t.match(/\\cos\{.*/)[0]).search(/\\cos\{/);break;default:return}if(a=n.search(/\\frac/),i=n.search(/\\sqrt\{/),(o=[a,c=n.search(/\\sqrt\[/),i,b=n.search(/\^/),_=n.search(/\\sin\{/),m=n.search(/\\tan\{/),g=n.search(/\\cos\{/)]).sort(function(e,t){return t-e}),(r=o[o.indexOf(0)-1])<=0||void 0===r)throw"syntax error";switch(r){case a:t=s(t);break;case i:t=l(t);break;case c:t=u(t);break;case b:t=d(t);break;case _:t=p(t);break;case m:t=f(t);break;case g:t=h(t)}switch(e){case"fraction":t=s(t);break;case"square root":t=l(t);break;case"nth root":t=u(t);break;case"nth power":t=d(t);break;case"sin":t=p(t);break;case"tan":t=f(t);break;case"cos":t=h(t)}return t},c()),n=(e=>{const{length:t}=e,n=[];for(let o=0;o<t;o+=1){const t=e[o-1]||"",r=e[o]||"",a=e[o+1]||"";/\.|[A-Za-z]/.test(t)||!/[A-Za-z]/.test(r)||/\.|[A-Za-z]/.test(a)||n.push({index:o,char:r})}return n})(t),a=[];return(0,r.default)(n,({char:e})=>{(0,o.default)(a,e)||a.push(e)}),{expression:t,args:n,flattenArgs:a}})},350:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TYPE_OUTPUT="OUTPUT_PIN",t.TYPE_INPUT="INPUT_PIN",t.RADIUS=7,t.S_RADIUS=4,t.WIDTH=8},352:function(e,t,n){(t=e.exports=n(24)(!1)).push([e.i,"\n",""]),t.locals={black0:"#1e1e1e",black1:"#2b2b2b",white0:"#d4d4d4",red0:"#f44336",purple0:"#c586c0",blue0:"#007acc",blue1:"#569cd6",blue2:"#9cdcfe",yellow0:"#dcdcaa",blockWidth:"200px"}},353:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_MATH=t.TYPE_VIEW=t.TYPE_OPERATOR=t.TYPE_PROPERTY=t.TYPE_FUNCTION=t.TYPE_VALUE=t.WIDTH=void 0;var o=a(n(192)),r=a(n(86));function a(e){return e&&e.__esModule?e:{default:e}}const{blockWidth:i}=r.default;t.WIDTH=(0,o.default)(i),t.TYPE_VALUE="VALUE_BLOCK",t.TYPE_FUNCTION="FUNCTION_BLOCK",t.TYPE_PROPERTY="PROPERTY_BLOCK",t.TYPE_OPERATOR="OPERATOR_BLCOK",t.TYPE_VIEW="VIEW_BLOCK",t.TYPE_MATH="MATH_BLOCK"},41:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_HANDWRITING=t.PIN=t.BLOCK=void 0;var o=a(n(353)),r=a(n(350));function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.BLOCK=o,t.PIN=r,t.EMPTY_HANDWRITING={expression:"",args:[],flattenArgs:[]}},449:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r,a=m(n(98)),i=m(n(202)),c=n(2),s=m(c),l=n(69),u=n(49),d=m(n(30)),p=m(n(68)),h=m(n(190)),f=n(88),b=n(41),_=m(n(349)),g=m(n(348));function m(e){return e&&e.__esModule?e:{default:e}}function v(e,t,n,o,r){var a={};return Object.keys(o).forEach(function(e){a[e]=o[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}n(347),window.ontouchmove=(()=>{});let y=(0,u.connect)()((v((r=class extends c.Component{constructor(){super(),this.prevX=0,this.prevY=0,this._editor=null}componentDidMount(){const{props:{model:e}}=this,t=e.get("type");if(t!==b.BLOCK.TYPE_VIEW){const e=(0,l.findDOMNode)(this).querySelector("[data-handwriting]");e.addEventListener("exported",this.onExported),_.default.register(e,{recognitionParams:{type:t===b.BLOCK.TYPE_MATH||t===b.BLOCK.TYPE_VALUE||t===b.BLOCK.TYPE_OPERATOR?"MATH":"TEXT",apiVersion:"V4",server:{applicationKey:"331b4bdf-7ace-4265-94f1-b01504c78743",hmacKey:"44f4f4ce-fd0f-48a1-b517-65d2b9465413"},v4:{math:{mimeTypes:["application/x-latex"]}}}});const{editor:n}=e;this._editor=n}}onExported(e){const{props:{model:t,dispatch:n}}=this,{detail:{exports:o}}=e;n(d.default.updateHandwriting({id:t.get("id"),handwriting:(0,g.default)(void 0===o?"":o["application/x-latex"])}))}clearMathEditor(){const{_editor:e}=this;e.clear()}onChange(e){const{props:{model:t,dispatch:n},_editor:o}=this,{currentTarget:{value:r}}=e;n(d.default.updateBlock(t.get("id"),{value:r})),o.clear()}onClickDeleteButton(){const{props:{model:e,dispatch:t}}=this,n=e.get("id");t(d.default.deleteBlock(n))}onMouseDownOrTouchStart(e){const{target:{dataset:t}}=e;if((0,i.default)(t,"draggable")){const{pageX:t,pageY:n}=(0,f.getMouseOrFirstTouchPosition)(e);this.prevX=t,this.prevY=n,document.body.classList.add("cursor-move"),document.addEventListener("mousemove",this.onMouseMoveOrTouchMoveDocument),document.addEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.addEventListener("touchmove",this.onMouseMoveOrTouchMoveDocument),document.addEventListener("touchend",this.onMouseUpOrTouchEndDocument)}}onMouseMoveOrTouchMoveDocument(e){const{pageX:t,pageY:n}=(0,f.getMouseOrFirstTouchPosition)(e),{props:{model:o,dispatch:r},prevX:a,prevY:i}=this;e.preventDefault(),r(d.default.deltaMoveBlock(o.get("id"),t-a,n-i)),this.prevX=t,this.prevY=n}onMouseUpOrTouchEndDocument(){document.body.classList.remove("cursor-move"),document.removeEventListener("mousemove",this.onMouseMoveOrTouchMoveDocument),document.removeEventListener("mouseup",this.onMouseUpOrTouchEndDocument),document.removeEventListener("touchmove",this.onMouseMoveOrTouchMoveDocument),document.removeEventListener("touchend",this.onMouseUpOrTouchEndDocument)}addPin(){const{props:{model:e,dispatch:t}}=this;t(d.default.addPin(e.get("id")))}deletePin(){const{props:{model:e,dispatch:t}}=this;t(d.default.deletePin({id:e.get("id"),removed:e.get("inputPins").size-1}))}onKeyDown(e){const{keyCode:t,currentTarget:{selectionStart:n,selectionEnd:o}}=e,{props:{dispatch:r,model:a}}=this;if(9===t){e.preventDefault();const t=a.get("value");r(d.default.updateBlock(a.get("id"),{value:`${t.substring(0,n)}\t${t.substring(o)}`}))}}render(){const{props:{model:e}}=this,t=e.get("color");if(e.get("type")!==b.BLOCK.TYPE_VIEW){const{flattenArgs:n}=e.get("handwriting");return s.default.createElement("div",{"data-draggable":!0,className:"Block__base_3ulp8",onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart,style:{position:"absolute",left:e.get("x"),top:e.get("y"),height:e.get("height")}},s.default.createElement("div",{"data-draggable":!0},e.get("deletable")?s.default.createElement("button",{className:"Block__red_1kUYK",onClick:this.onClickDeleteButton},"x"):null,e.get("changeable")?s.default.createElement("button",{onClick:this.addPin},"+"):null,e.get("changeable")?s.default.createElement("button",{onClick:this.deletePin},"-"):null,s.default.createElement("button",{onClick:this.clearMathEditor},"Clear")),s.default.createElement("div",{"data-draggable":!0,className:"Block__math-div_2fcEH"},s.default.createElement("input",{type:"text",readOnly:!e.get("editable"),value:e.get("value"),onChange:this.onChange,style:{borderLeft:`5px solid ${t}`}}),(0,a.default)(n,(e,t)=>s.default.createElement("div",{className:"Block__math-arg_3aTuw",key:t,style:{top:2*b.PIN.WIDTH*t+6}},e)),s.default.createElement("div",{className:"Block__math_2WDqM","data-handwriting":!0})))}return s.default.createElement("div",{"data-draggable":!0,className:"Block__base_3ulp8",onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart,style:{position:"absolute",left:e.get("x"),top:e.get("y"),height:e.get("height")}},s.default.createElement("div",{"data-draggable":!0},e.get("deletable")?s.default.createElement("button",{className:"Block__red_1kUYK",onClick:this.onClickDeleteButton},"x"):null,e.get("changeable")?s.default.createElement("button",{onClick:this.addPin},"+"):null,e.get("changeable")?s.default.createElement("button",{onClick:this.deletePin},"-"):null),s.default.createElement("div",{"data-draggable":!0,className:"Block__textarea-div_19vCU"},s.default.createElement(h.default,{readOnly:!e.get("editable"),onChange:this.onChange,value:e.get("value"),spellCheck:!1,style:{borderLeft:`5px solid ${t}`},onKeyDown:this.onKeyDown})))}}).prototype,"onExported",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onExported"),r.prototype),v(r.prototype,"clearMathEditor",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"clearMathEditor"),r.prototype),v(r.prototype,"onChange",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onChange"),r.prototype),v(r.prototype,"onClickDeleteButton",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onClickDeleteButton"),r.prototype),v(r.prototype,"onMouseDownOrTouchStart",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseDownOrTouchStart"),r.prototype),v(r.prototype,"onMouseMoveOrTouchMoveDocument",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseMoveOrTouchMoveDocument"),r.prototype),v(r.prototype,"onMouseUpOrTouchEndDocument",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseUpOrTouchEndDocument"),r.prototype),v(r.prototype,"addPin",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"addPin"),r.prototype),v(r.prototype,"deletePin",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"deletePin"),r.prototype),v(r.prototype,"onKeyDown",[p.default],Object.getOwnPropertyDescriptor(r.prototype,"onKeyDown"),r.prototype),o=r))||o;t.default=y},462:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r,a=y(n(79)),i=n(2),c=y(i),s=n(49),l=y(n(449)),u=y(n(345)),d=y(n(30)),p=y(n(324)),h=y(n(323)),f=y(n(68)),b=y(n(322)),_=n(41),g=n(122),m=n(88),v=n(182);function y(e){return e&&e.__esModule?e:{default:e}}function P(e,t,n,o,r){var a={};return Object.keys(o).forEach(function(e){a[e]=o[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}n(309),window.ontouchmove=(()=>{});let E=(0,s.connect)(({blocks:e,pointLink:t,pinLinks:n,blockCreator:o})=>({blocks:e,link:t,links:n,blockCreator:o}))((P((r=class e extends i.Component{static convertPinTypeToPinLinkKey(e){switch(e){case _.PIN.TYPE_OUTPUT:return"output";case _.PIN.TYPE_INPUT:return"input";default:throw new Error("Unknown pin type")}}componentDidMount(){window.addEventListener("message",this.onMessage)}componentWillUnmount(){window.removeEventListener("message",this.onMessage)}onConnectStart(e,t,n){const{props:{dispatch:o}}=this,r=t.get("type"),a=t.get("index"),i=[d.default.startPointLink({x:t.get("cx"),y:t.get("cy")})];document.addEventListener("mousemove",this.onConnecting),document.addEventListener("mouseup",this.onConnectEnd),document.addEventListener("touchmove",this.onConnecting),document.addEventListener("touchend",this.onConnectEnd),window.__connection__={block:n,pin:a,pinType:r},r===_.PIN.TYPE_INPUT&&i.push(d.default.removePinLinkByQuery({input:{block:n,pin:a}})),o((0,g.batchActions)(i))}onConnecting(e){const{props:{dispatch:t}}=this,{clientX:n,clientY:o}=(0,m.getMouseOrFirstTouchPosition)(e);e.preventDefault(),t(d.default.endPointLink({x:n,y:o}))}onConnectEnd(){const{props:{dispatch:e}}=this;e(d.default.startPointLink({x:0,y:0})),document.removeEventListener("mousemove",this.onConnecting),document.removeEventListener("mouseup",this.onConnectEnd),document.removeEventListener("touchmove",this.onConnecting),document.removeEventListener("touchend",this.onConnectEnd)}onConnectPin(t,n,o){const{__connection__:{block:r,pin:a,pinType:i}}=window,{props:{dispatch:c}}=this,s=n.get("index"),l=n.get("type");r!==o&&i!==l&&c(d.default.addPinLink({[e.convertPinTypeToPinLinkKey(i)]:{block:r,pin:a},[e.convertPinTypeToPinLinkKey(l)]:{block:o,pin:s}}))}onMessage(e){const{props:{dispatch:t}}=this,{data:{type:n,value:o}}=e;"chain-result"===n?t(d.default.pushViewBlock(JSON.stringify(o))):"chain-error"===n?v.toast.error(o,{position:v.toast.POSITION.BOTTOM_RIGHT}):"chain-clear"===n&&t(d.default.clearViewBlock())}onMouseDownOrTouchStart(e){const{target:t,currentTarget:n}=e,{clientX:o,clientY:r}=(0,m.getMouseOrFirstTouchPosition)(e),{props:{dispatch:a}}=this;t===n&&a(d.default.showBlockCreator({x:o,y:r}))}render(){const{props:{link:e,links:t,blockCreator:n}}=this;let{props:{blocks:o}}=this;return c.default.createElement("div",{className:"Chain__base_L0Lag"},c.default.createElement("svg",{onMouseDown:this.onMouseDownOrTouchStart,onTouchStart:this.onMouseDownOrTouchStart},t.map((e,t)=>((0,a.default)(["input","output"],t=>{const n=o.findIndex(n=>n.get("id")===e.getIn([t,"block"]));o=o.setIn([n,`${t}Pins`,e.getIn([t,"pin"]),"linked"],!0)}),c.default.createElement(h.default,{key:t,model:e}))),c.default.createElement(p.default,{model:e})),o.map(e=>{const t=e.get("id");return[c.default.createElement(l.default,{key:t,model:e}),e.get("inputPins").map(e=>c.default.createElement(b.default,{key:e.get("index"),model:e,parent:t,onMouseDownOrTouchStart:this.onConnectStart,onMouseUpOrTouchEnd:this.onConnectPin})),e.get("outputPins").map(e=>c.default.createElement(b.default,{key:e.get("index"),model:e,parent:t,onMouseDownOrTouchStart:this.onConnectStart,onMouseUpOrTouchEnd:this.onConnectPin}))]}),c.default.createElement(u.default,{model:n}))}}).prototype,"onConnectStart",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onConnectStart"),r.prototype),P(r.prototype,"onConnecting",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onConnecting"),r.prototype),P(r.prototype,"onConnectEnd",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onConnectEnd"),r.prototype),P(r.prototype,"onConnectPin",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onConnectPin"),r.prototype),P(r.prototype,"onMessage",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onMessage"),r.prototype),P(r.prototype,"onMouseDownOrTouchStart",[f.default],Object.getOwnPropertyDescriptor(r.prototype,"onMouseDownOrTouchStart"),r.prototype),o=r))||o;t.default=E},465:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),r=g(o),a=n(49),i=g(n(462)),c=n(175),s=g(n(307)),l=n(122),u=n(266),d=g(n(294)),p=g(n(289)),h=g(n(30)),f=n(182),b=n(41),_=g(n(274));function g(e){return e&&e.__esModule?e:{default:e}}const{link:m,active:v}=_.default,y=(0,c.createStore)((0,l.enableBatching)(s.default));y.dispatch(h.default.addBlock({x:100,y:100,type:b.BLOCK.TYPE_VIEW}));const P=()=>r.default.createElement(u.Redirect,{to:"/chain"});t.default=class extends o.Component{render(){return r.default.createElement(a.Provider,{store:y},r.default.createElement(u.HashRouter,null,r.default.createElement("div",{className:"App__wrap_1SQHV"},r.default.createElement("div",{className:"App__base_2Rw2G"},r.default.createElement(d.default,null),r.default.createElement(u.Route,{exact:!0,path:"/",render:P}),r.default.createElement(u.Route,{path:"/chain",component:i.default}),r.default.createElement(u.Route,{path:"/editor",component:p.default})),r.default.createElement("footer",null,r.default.createElement(u.NavLink,{to:"/chain",className:m,activeClassName:v},r.default.createElement("span",null,"Chain")),r.default.createElement(u.NavLink,{to:"/editor",className:m,activeClassName:v},r.default.createElement("span",null,"Editor")),r.default.createElement(u.NavLink,{to:"/view",className:m,activeClassName:v},r.default.createElement("span",null,"View"))),r.default.createElement(f.ToastContainer,{autoClose:3e3}))))}}},474:function(e,t,n){"use strict";var o=i(n(2)),r=n(69),a=i(n(465));function i(e){return e&&e.__esModule?e:{default:e}}n(272),n(270),n(268),(0,r.render)(o.default.createElement(a.default,null),document.querySelector("main"))},677:function(e,t,n){n(676),e.exports=n(474)},83:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PinLink=t.PointLink=t.BlockCreator=t.Pin=t.Block=void 0;var o=h(n(304)),r=h(n(25)),a=h(n(183)),i=h(n(202)),c=h(n(79)),s=h(n(98)),l=h(n(300)),u=n(121),d=n(41),p=h(n(86));function h(e){return e&&e.__esModule?e:{default:e}}const{white0:f,purple0:b,blue1:_,yellow0:g}=p.default;t.Block=class e extends((0,u.Record)({id:0,value:"",x:0,y:0,deletable:!0,editable:!0,type:"",color:f,changeable:!0,outputPins:(0,u.List)(),inputPins:(0,u.List)(),height:70,handwriting:d.EMPTY_HANDWRITING})){constructor(e){super(e);const{type:t}=this;let n=null;switch(t){case d.BLOCK.TYPE_VIEW:n={editable:!1,deletable:!1,color:b,inputPins:this._createPins([f],d.PIN.TYPE_INPUT)};break;case d.BLOCK.TYPE_VALUE:n={changeable:!1,outputPins:this._createPins([b],d.PIN.TYPE_OUTPUT)};break;case d.BLOCK.TYPE_FUNCTION:n={color:_,inputPins:this._createPins([_],d.PIN.TYPE_INPUT),outputPins:this._createPins([b],d.PIN.TYPE_OUTPUT)};break;case d.BLOCK.TYPE_PROPERTY:n={changeable:!1,color:g,inputPins:this._createPins([f],d.PIN.TYPE_INPUT),outputPins:this._createPins([f],d.PIN.TYPE_OUTPUT)};break;case d.BLOCK.TYPE_OPERATOR:n={changeable:!1,inputPins:this._createPins([f,f],d.PIN.TYPE_INPUT),outputPins:this._createPins([f],d.PIN.TYPE_OUTPUT)};break;case d.BLOCK.TYPE_MATH:n={changeable:!1,editable:!1,outputPins:this._createPins([f],d.PIN.TYPE_OUTPUT),height:200};break;default:throw new Error(`Unknown type: ${t}.`)}return this.merge(n).recalculateHeight()}recalculateHeight(){const{type:e,inputPins:{size:t},outputPins:{size:n}}=this;let o=Math.max(4,t+2,n+2)*(2*d.PIN.RADIUS+3)-1;return e!==d.BLOCK.TYPE_VIEW&&(o=Math.max(200,o)),this.set("height",o)}dmove(e,t){const{x:n,y:o,inputPins:r,outputPins:a}=this;return this.merge({x:n+e,y:o+t,inputPins:r.map(n=>n.dmove(e,t)),outputPins:a.map(n=>n.dmove(e,t))})}createPin(t,n,o=null){const{x:r,y:a}=this,i=e.convertPinTypeToPinKey(n),{size:c}=this.get(i),s=(0,l.default)(o)?c:o,[u,d]=e._pinPosition(s,n);return new m({index:s,color:t,type:n,cx:r+u,cy:a+d})}_createPins(t,n){const o=this.get(e.convertPinTypeToPinKey(n));return 0===o.size?(0,u.List)((0,s.default)(t,(e,t)=>this.createPin(e,n,t))):o}static convertPinTypeToPinKey(e){switch(e){case d.PIN.TYPE_OUTPUT:return"outputPins";case d.PIN.TYPE_INPUT:return"inputPins";default:throw new Error("Unknown pin type")}}static _pinPosition(e,t){return[t===d.PIN.TYPE_INPUT?-d.PIN.RADIUS-2:t===d.PIN.TYPE_OUTPUT?d.BLOCK.WIDTH+d.PIN.RADIUS:0,21+d.PIN.RADIUS+(2*d.PIN.RADIUS+3)*e+1]}};let m=t.Pin=class extends((0,u.Record)({index:0,color:f,type:"",linked:!1,cx:0,cy:0})){dmove(e,t){const{cx:n,cy:o}=this;return this.merge({cx:n+e,cy:o+t})}};t.BlockCreator=class extends((0,u.Record)({x:0,y:0,visible:!1,value:"",selected:d.BLOCK.TYPE_VALUE})){show(e,t){return this.merge({visible:!0,x:e,y:t,value:"",selected:d.BLOCK.TYPE_VALUE})}},t.PointLink=class extends((0,u.Record)({ax:0,ay:0,bx:0,by:0})){start(e,t){return this.merge({ax:e,ay:t,bx:e,by:t})}end(e,t){return this.merge({bx:e,by:t})}points(){const{ax:e,ay:t,bx:n,by:o}=this;return[e,t,n,o]}},t.PinLink=class e extends((0,u.Record)({output:(0,u.Map)({block:0,pin:0}),input:(0,u.Map)({block:0,pin:0})})){constructor(e){(0,c.default)(["output","input"],t=>{(0,i.default)(e,t)&&(e[t]=(0,u.Map)(e[t]))}),super(e)}hasBlock(e){return(0,a.default)(["output","input"],t=>this.getIn([t,"block"])===e)}match({output:t,input:n}){return e._matcher(this.get("output"),t)&&e._matcher(this.get("input"),n)}static _matcher(t,n){return(0,r.default)(n)?!(0,a.default)((0,o.default)(n),([n,o])=>!e._matcher(t.get(n),o)):void 0!==t&&(void 0===n||t===n)}}},86:function(e,t,n){var o=n(352);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(23)(o,r);o.locals&&(e.exports=o.locals)},88:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generator=t.getMouseOrFirstTouchPosition=t.cosineCurvePoints=t.dist=void 0;var o=a(n(192)),r=a(n(191));function a(e){return e&&e.__esModule?e:{default:e}}const i=t.dist=((e,t,n,o)=>Math.sqrt(Math.pow(e-n,2)+Math.pow(t-o,2)));t.cosineCurvePoints=((e,t,n,o,r=10)=>{const a=i(e,t,n,o);if(0===a)return[];const c=(n-e)/a,s=o-t,l=[];for(let u=0;u<=a;u+=1){const d=e+c*u,p=t+s*(1-Math.cos(Math.PI/a*u))/2;r<i(e,t,d,p)&&r<i(n,o,d,p)&&l.push(d,p)}return l}),t.getMouseOrFirstTouchPosition=(e=>{const{type:t,changedTouches:n}=e;if((0,r.default)(["mousedown","mousemove","mouseup"],t))return e;if((0,r.default)(["touchstart","touchmove","touchend"],t))return n.item(0);throw new Error("Unknown event type")}),t.generator=new class e{static get ZEROS_42(){return"000000000000000000000000000000000000000000"}static get ZEROS_12(){return"000000000000"}constructor(){this.sequence=0,this.ptime=0}id(){const t=Date.now();t===this.ptime?this.sequence+=1:this.sequence=0;const n=(e.ZEROS_42+(t-1288834974657).toString(2)).slice(-42),r=(e.ZEROS_12+this.sequence.toString(2)).slice(-12);return(0,o.default)(`${n}${r}`,2)}}}});